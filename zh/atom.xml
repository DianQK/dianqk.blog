<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh">
    <title></title>
    <link href="https://dianqk.blog/zh/atom.xml" rel="self" type="application/atom+xml"/>
    <link href="https://dianqk.blog"/>
    <generator uri="https://www.getzola.org/">Zola</generator>
    <updated>2023-10-28T00:00:00+00:00</updated>
    <id>https://dianqk.blog/zh/atom.xml</id>
    <entry xml:lang="zh">
        <title>2023 æ€»ç»“</title>
        <published>2023-10-28T00:00:00+00:00</published>
        <updated>2023-10-28T00:00:00+00:00</updated>
        <author>
          <name>Unknown</name>
        </author>
        <link rel="alternate" href="https://dianqk.blog/zh/2023-summary/" type="text/html"/>
        <id>https://dianqk.blog/zh/2023-summary/</id>
        
        <content type="html">&lt;h1 id=&quot;gai-gua&quot;&gt;æ¦‚æ‹¬&lt;&#x2F;h1&gt;
&lt;p&gt;ä»Šå¹´æ˜¯æˆ‘ç¬¬ä¸€å¹´æŒç»­å‚ä¸å¼€æºè´¡çŒ®å·¥ä½œï¼Œæˆ‘ä¿®å¤äº†è®¸å¤šé”™è¯¯ç¼–è¯‘ï¼Œä¹Ÿå¢åŠ äº†ä¸€äº›ç¼ºå¤±çš„ä¼˜åŒ–ã€‚è¿˜æœ‰ä¸€äº›æˆ‘ä¸çŸ¥é“å¦‚ä½•å½’ç±»ï¼Œæ¶‰åŠå„ç§å†…å®¹ï¼Œæ¯”å¦‚ LTOã€DebugInfoï¼Œå†…ç½®å‡½æ•°å’Œ WebAssemblyï¼Œç”šè‡³è¿˜æœ‰ Apple Silicon ç›¸å…³ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘å¾—åˆ°äº†è®¸å¤šçš„äººçš„å¸®åŠ©ï¼Œå°¤å…¶æ˜¯å®¡æ ¸æˆ‘çš„ PR çš„äººï¼Œéå¸¸æ„Ÿè°¢ã€‚(â—Â´âˆ€ï½€â—)&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;ä¸€äº›å€¼å¾—æ³¨æ„çš„å†…å®¹ï¼š&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;æˆ‘ææ¸…æ¥šäº†ä¸€ä¸ªé•¿æœŸå­˜åœ¨çš„ LTO ä¸‹è°ƒè¯•ä¿¡æ¯æŸåçš„é—®é¢˜&lt;&#x2F;li&gt;
&lt;li&gt;æˆ‘å°† Rust ä¸­å†…ç½®å‡½æ•°çš„ crate ä¹Ÿæ·»åŠ è¿› LTOï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªé•¿æœŸå­˜åœ¨çš„é—®é¢˜&lt;&#x2F;li&gt;
&lt;li&gt;ä¸ºäº†æ›´æ–¹ä¾¿çš„äº¤æµï¼Œæˆ‘ç»™è‡ªå·±èµ·äº†ä¸€ä¸ªè‹±æ–‡åï¼šQuentin Dian&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;æˆ‘ä½¿ç”¨è¿™äº›è¡¨æƒ…å¯¹ç›¸å…³å·¥ä½œè¿›è¡Œåˆ†ç±»ï¼š&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;ğŸ’¢ æŒ‡é”™è¯¯ç¼–è¯‘&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ» è¡¥å……ç¼ºå¤±çš„ä¼˜åŒ–&lt;&#x2F;li&gt;
&lt;li&gt;â„¹ï¸ ä¸è°ƒè¯•æœ‰å…³&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ¦€ ä¸ Rust æœ‰å…³&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ‰ ä¸ LLVM æœ‰å…³&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ¦ ä¸ Swift æœ‰å…³&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ ä¸ Apple æœ‰å…³&lt;&#x2F;li&gt;
&lt;li&gt;â³ è¢«å…¶ä»–é—®é¢˜é˜»å¡&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h1 id=&quot;llvm&quot;&gt;LLVM&lt;&#x2F;h1&gt;
&lt;p&gt;æäº¤è®°å½•ï¼š&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;commits?author=DianQK&amp;amp;since=2023-01-01&amp;amp;until=2023-12-31&quot;&gt;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;commits?author=DianQK&amp;amp;since=2023-01-01&amp;amp;until=2023-12-31&lt;&#x2F;a&gt;ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;å¯¹äº†ï¼Œæˆ‘çš„ç¬¬ä¸€ä¸ª LLVM æäº¤æ˜¯ï¼š&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;commit&#x2F;1e9fa0b12a7619add4a259f80315f984b5f7e2ce&quot;&gt;[MachineOutliner] Fix the side effect of outlined function when the register is implicit use and implicit-def in the same instruction. D112911&lt;&#x2F;a&gt;ã€‚&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;ğŸ»ğŸ¦€â³ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;commit&#x2F;b6a0be8ce3114d0c57e7a7d6c3c222986ca506ad&quot;&gt;[SimplifyCFG] Check if the return instruction causes undefined behavior D144319&lt;&#x2F;a&gt; è¢« &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;pull&#x2F;69498&quot;&gt;PR69498&lt;&#x2F;a&gt; é˜»å¡&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ»â³ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;commit&#x2F;f890f010f6a70addbd885acd0c8d1b9578b6246f&quot;&gt;[SimplifyCFG] Improve the precision of &lt;code&gt;PtrValueMayBeModified&lt;&#x2F;code&gt; D144563&lt;&#x2F;a&gt; è·Ÿéš D144319 çš„æäº¤ï¼Œå°½ç®¡è¿™æ²¡æœ‰è¢«  &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;pull&#x2F;69498&quot;&gt;PR69498&lt;&#x2F;a&gt; é˜»å¡&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ’¢ğŸ¦€ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;commit&#x2F;2832d7941f4207f1fcf813b27cf08cecc3086959&quot;&gt;[SROA] Remove UB-implying metadata when promoting speculative instruction. D148456&lt;&#x2F;a&gt; ä¿®å¤ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;issues&#x2F;110256&quot;&gt;PR110256&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ’¢ğŸ¦€ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;commit&#x2F;533b7c1f6c696817df332cc7c9acbe3b454eadf2&quot;&gt;[GlobalOpt] Don&#x27;t replace the aliasee if it has other references. D145293&lt;&#x2F;a&gt; ä¿®å¤ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;issues&#x2F;108030&quot;&gt;PR108030&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ¦€ğŸ¦â„¹ï¸ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;commit&#x2F;2ee4d0386c783f58abe708298228de648239b435&quot;&gt;[Verifier] definition subprograms cannot be nested within DICompositeType when enabling ODR. D152095&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ¦â„¹ï¸ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;commit&#x2F;ca1a5b37c7236dd29a3169859153dfdcce066b51&quot;&gt;[Coroutine][DebugInfo] Update the linkage name of the declaration of coro-split functions in the debug info. D157184&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ’¢ğŸ¦€ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;commit&#x2F;c3f227ead65c606409ff8cc3333a6c751f156a9c&quot;&gt;[TailCallElim] Remove the readonly attribute of byval. D156793&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ’¢ğŸ¦€ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;pull&#x2F;65219&quot;&gt;[JumpThreading] Invalidate LVI after combineMetadataForCSE. #65219&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ»ğŸ¦€ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;pull&#x2F;65875&quot;&gt;[EarlyCSE] Compare GEP instructions based on offset #65875&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ»ğŸ¦€ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;pull&#x2F;67077&quot;&gt;[SimplifyCFG] Hoist common instructions on switch #67077&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ’¢ğŸ¦€ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;pull&#x2F;67539&quot;&gt;[MemCpyOpt] Merge alias metadatas when replacing arguments #67539&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ’¢ğŸ¦€ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;pull&#x2F;68190&quot;&gt;[LVI][CVP] Treat undef like a full range #68190&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ’¢ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;pull&#x2F;68711&quot;&gt;[LVI][CVP] Treat undef like a full range on abs(x, false) #68711&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ’¢ğŸ¦€ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;pull&#x2F;70580&quot;&gt;[MemCpyOpt] Combine alias metadatas when replacing byval arguments #70580&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ’¢ğŸ¦€ğŸ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;pull&#x2F;75184&quot;&gt;[AArch64] ORRWrs is copy instruction when there&#x27;s no implicit def of the X register #75184&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;h1 id=&quot;rust&quot;&gt;Rust&lt;&#x2F;h1&gt;
&lt;p&gt;æäº¤è®°å½•ï¼š&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;commits?author=DianQK&amp;amp;since=2023-01-01&amp;amp;until=2023-12-31&quot;&gt;https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;commits?author=DianQK&amp;amp;since=2023-01-01&amp;amp;until=2023-12-31&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;é™¤äº†æ›´æ–°æµ‹è¯•ç”¨ä¾‹ç­‰ç®€å• PRï¼Œå…¶ä»–éƒ½æ˜¯å›´ç»• builtins &amp;amp; LTO çš„ PRï¼š&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;pull&#x2F;113716&quot;&gt;Add the &lt;code&gt;no-builtins&lt;&#x2F;code&gt; attribute to functions when &lt;code&gt;no_builtins&lt;&#x2F;code&gt; is applied at the crate level. #113716&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;pull&#x2F;113923&quot;&gt;Restore &lt;code&gt;#![no_builtins]&lt;&#x2F;code&gt; crates participation in LTO. #113923&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;pull&#x2F;118036&quot;&gt;Add thinlto support to codegen, assembly and coverage tests #118036&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;pull&#x2F;118568&quot;&gt;Avoid adding builtin functions to &lt;code&gt;symbols.o&lt;&#x2F;code&gt; #118568&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;å°½ç®¡åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­è§£å†³äº†å¾ˆå¤šé—®é¢˜ï¼Œä¸å¹¸çš„æ˜¯ï¼Œä»ç„¶æœ‰ä¸€äº›&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;issues&#x2F;118609&quot;&gt;å·²çŸ¥é—®é¢˜&lt;&#x2F;a&gt;éœ€è¦è§£å†³ã€‚åœ¨è§£å†³è¿™äº›é—®é¢˜ä¹‹åï¼Œæˆ‘ä¼šæäº¤ç›¸å…³çš„ MCPã€‚&lt;&#x2F;p&gt;
&lt;h1 id=&quot;ruslin&quot;&gt;Ruslin&lt;&#x2F;h1&gt;
&lt;p&gt;æˆ‘ä½¿ç”¨ Joplin è®°ç¬”è®°ï¼Œä½†æˆ‘ä¸å–œæ¬¢ Joplin çš„ Android å®¢æˆ·ç«¯ã€‚ä¸ºæ­¤æˆ‘ç¼–å†™äº†ä¸€ä¸ªå…¼å®¹çš„å®¢æˆ·ç«¯ï¼š&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;ruslin-note&#x2F;ruslin-android&quot;&gt;ruslin-android&lt;&#x2F;a&gt;ã€‚å¾ˆæŠ±æ­‰æœ€è¿‘ä¸€ç›´æ²¡æœ‰æ›´æ–°ï¼Œæˆ‘ä¼šåœ¨æ˜å¹´å°è¯•è°ƒæ•´ä¸€ä¸‹æˆ‘çš„ä¸šä½™æ—¶é—´ã€‚äº‹å®ä¸Šæˆ‘ä¹Ÿåœ¨è€ƒè™‘æ¡Œé¢ç«¯çš„å¼€å‘ã€‚&lt;&#x2F;p&gt;
&lt;h1 id=&quot;qi-ta-xiang-mu&quot;&gt;å…¶ä»–é¡¹ç›®&lt;&#x2F;h1&gt;
&lt;ul&gt;
&lt;li&gt;â„¹ï¸ğŸ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;apple&#x2F;swift&#x2F;pull&#x2F;67077&quot;&gt;[swift][IRGen][DebugInfo] split method declaration and definition. #67077&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;â„¹ï¸ğŸ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;apple&#x2F;swift&#x2F;pull&#x2F;67592&quot;&gt;[swift][Backtracing][Linux] Support the &lt;code&gt;DW_AT_specification&lt;&#x2F;code&gt; attribute. #67592 &lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ¦€ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;wasm3&#x2F;wasm3&#x2F;pull&#x2F;436&quot;&gt;[wasm3] Fix the issue of incorrectly freeing the stack address when unwinding local functions. #436&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;ğŸ¦€ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;DioxusLabs&#x2F;dioxus&#x2F;pull&#x2F;1112&quot;&gt;[dioxus] Fix the issue of duplicate unique ID for atoms using &lt;code&gt;newtype&lt;&#x2F;code&gt;. #1112&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h1 id=&quot;ge-ren-xiang-guan&quot;&gt;ä¸ªäººç›¸å…³&lt;&#x2F;h1&gt;
&lt;p&gt;DianQK åªæ˜¯æˆ‘éšæ„èµ·å¾—ä¸­æ–‡ç¬”åé›ï¼ˆDianï¼‰é’ï¼ˆQingï¼‰Kçš„æ‹¼éŸ³ç¼©å†™ï¼Œé›é’æŒ‡ indigoã€‚è¿™å¯¼è‡´å¤§å®¶ä¸çŸ¥é“è¯¥å¦‚ä½•ç§°å‘¼æˆ‘ã€‚ä¸ºæ­¤æˆ‘å‘ ChatGPT è¯¢é—®äº†ä¸€ä¸ªåå­—ï¼šQuentin Dianã€‚æ‰€ä»¥ä½ å¯ä»¥å«æˆ‘ Dian æˆ–è€… dianqk éƒ½å¯ä»¥ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æ›¾ç»æˆ‘ä¸€ç›´åœ¨ä½¿ç”¨ Arch Linuxï¼Œç°åœ¨æˆ‘å…¨éƒ¨åˆ‡æ¢åˆ°äº† NixOSï¼Œè¿™æ˜¯ä¸ªå¾ˆæ£’çš„æ“ä½œç³»ç»Ÿï¼Œæˆ‘å¯ä»¥ç”¨ä»£ç ç®¡ç†ä¸€åˆ‡ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;ä¸ºäº†æé«˜æˆ‘çš„æ•ˆç‡ï¼Œæˆ‘è¿˜è´­ä¹°äº† GPD æŒæœºï¼Œä¸Šé¢çš„å¤§éƒ¨åˆ†ä»£ç éƒ½æ˜¯æˆ‘åœ¨åœ°é“ä¸Šä½¿ç”¨ GPD å®Œæˆçš„ã€‚æˆ‘è¿˜ç»„è£…äº†ä¸€å° 7950X ä¸»æœºï¼Œè¿™å°†æˆ‘çš„æœ¬åœ°æ„å»ºæ—¶é—´ç¼©çŸ­äº†ä¸€åŠï¼Œæˆ‘å¯ä»¥åœ¨å‡ åˆ†é’Ÿä¹‹å†…å®Œæˆä¸€æ¬¡å…¨é‡ç¼–è¯‘ã€‚æˆ‘è¿˜ä¹°äº†ä¸€å° Mac miniï¼ˆM2ï¼‰ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥æµ‹è¯•è¿™ä¸ªå¹³å°çš„é—®é¢˜äº†ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;2023-10-28-summary-gpd.jpg&quot; alt=&quot;GPG Win 4&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="zh">
        <title>ä½¿ç”¨å¥½åæ¯”è¾ƒå‘ç° rust ä¸­çš„ LLVM bug</title>
        <published>2023-10-15T00:00:00+00:00</published>
        <updated>2023-10-15T00:00:00+00:00</updated>
        <author>
          <name>Unknown</name>
        </author>
        <link rel="alternate" href="https://dianqk.blog/zh/finding-llvm-bugs-in-rustc-with-comparisons/" type="text/html"/>
        <id>https://dianqk.blog/zh/finding-llvm-bugs-in-rustc-with-comparisons/</id>
        
        <content type="html">&lt;h1 id=&quot;zhai-yao&quot;&gt;æ‘˜è¦&lt;&#x2F;h1&gt;
&lt;p&gt;åœ¨å¤§å‹å·¥ç¨‹ä¸­å®šä½é—®é¢˜æ€»æ˜¯å¾ˆå¤æ‚çš„ï¼Œæºæ‚åœ¨ rust ä¸­çš„ LLVM çš„ bug å°±æ˜¯è¿™ç±»æƒ…å†µã€‚æˆ‘å°†åœ¨æœ¬æ–‡ä»‹ç»æˆ‘å¦‚ä½•å®šä½ stage2 ä¸‹ rust å•å…ƒæµ‹è¯•å¤±è´¥é—®é¢˜ã€‚
æˆ‘å°†å›´ç»• &lt;a href=&quot;https:&#x2F;&#x2F;rust-lang.zulipchat.com&#x2F;#narrow&#x2F;stream&#x2F;131828-t-compiler&#x2F;topic&#x2F;Failing.20tests.20when.20rustc.20is.20compiled.20with.201.20CGU&quot;&gt;Failing tests when rustc is compiled with 1 CGU&lt;&#x2F;a&gt; å’Œ &lt;a href=&quot;https:&#x2F;&#x2F;rust-lang.zulipchat.com&#x2F;#narrow&#x2F;stream&#x2F;131828-t-compiler&#x2F;topic&#x2F;Implementing.20niche.20checks&quot;&gt;Implementing niche checks&lt;&#x2F;a&gt; è®°å½•æˆ‘è§£å†³è¿™ç±»é—®é¢˜çš„è¿‡ç¨‹ï¼Œå¸Œæœ›èƒ½å¯¹åç»­è§£å†³è¯¥ç±»é—®é¢˜æœ‰æ‰€å¸®åŠ©ã€‚&lt;&#x2F;p&gt;
&lt;h1 id=&quot;kai-shi-zhi-qian&quot;&gt;å¼€å§‹ä¹‹å‰&lt;&#x2F;h1&gt;
&lt;ul&gt;
&lt;li&gt;ç”±äºè¿™æ˜¯æˆ‘è§£å†³åçš„æ€»ç»“æ–‡ç« ï¼Œæˆ‘å¯èƒ½ä¼šç–æ¼ä¸€äº›è¯¦ç»†è¿‡ç¨‹ï¼Œè¿˜è¯·è§è°…ã€‚&lt;&#x2F;li&gt;
&lt;li&gt;æ¬¢è¿æäº¤ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;DianQK&#x2F;dianqk.blog&#x2F;issues&quot;&gt;issue&lt;&#x2F;a&gt; æˆ– &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;DianQK&#x2F;dianqk.blog&#x2F;pulls&quot;&gt;PR&lt;&#x2F;a&gt; æ”¹æ­£æ–‡ç« çš„é”™è¯¯&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;æˆ‘ä¸ºæœ¬æ–‡å‡†å¤‡äº†å¯¹åº”çš„å·¥ç¨‹ï¼Œå‚è§ï¼š&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;DianQK&#x2F;rust&#x2F;tree&#x2F;blog&#x2F;repro-1-cgu&quot;&gt;https:&#x2F;&#x2F;github.com&#x2F;DianQK&#x2F;rust&#x2F;tree&#x2F;blog&#x2F;repro-1-cgu&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;DianQK&#x2F;llvm-project&#x2F;tree&#x2F;blog&#x2F;repro-1-cgu&quot;&gt;https:&#x2F;&#x2F;github.com&#x2F;DianQK&#x2F;llvm-project&#x2F;tree&#x2F;blog&#x2F;repro-1-cgu&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;DianQK&#x2F;rust&#x2F;tree&#x2F;blog&#x2F;mir-niche-checks&quot;&gt;https:&#x2F;&#x2F;github.com&#x2F;DianQK&#x2F;rust&#x2F;tree&#x2F;blog&#x2F;mir-niche-checks&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;DianQK&#x2F;llvm-project&#x2F;tree&#x2F;blog&#x2F;mir-niche-checks&quot;&gt;https:&#x2F;&#x2F;github.com&#x2F;DianQK&#x2F;llvm-project&#x2F;tree&#x2F;blog&#x2F;mir-niche-checks&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;ä¿®å¤è¿™ä¸¤ä¸ªé—®é¢˜çš„ PR æ˜¯ï¼š&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;pull&#x2F;67539&quot;&gt;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;pull&#x2F;67539&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;pull&#x2F;68190&quot;&gt;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;pull&#x2F;68190&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h1 id=&quot;di-1-ge-wen-ti-de-fu-xian-fang-shi&quot;&gt;ç¬¬ 1 ä¸ªé—®é¢˜çš„å¤ç°æ–¹å¼&lt;&#x2F;h1&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬éœ€è¦åˆ‡æ¢åˆ°å¯ä»¥å¤ç°çš„ç‰ˆæœ¬ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;git&lt;&#x2F;span&gt;&lt;span&gt; clone https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust.git
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;git&lt;&#x2F;span&gt;&lt;span&gt; checkout 085acd02d4abaf2ccaf629134caa83cfe23283c8
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ç„¶åéœ€è¦ä¿®æ”¹ &lt;code&gt;config.toml&lt;&#x2F;code&gt;ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;toml&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-toml &quot;&gt;&lt;code class=&quot;language-toml&quot; data-lang=&quot;toml&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;profile &lt;&#x2F;span&gt;&lt;span&gt;= &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;dist&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;[build]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;profiler &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;true
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;[rust]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;codegen-units &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;optimize &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;2
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜éœ€è¦äº†è§£ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rustc-perf&quot;&gt;rustc-perf&lt;&#x2F;a&gt; å¦‚ä½•ä½¿ç”¨ï¼Œç„¶åä½¿ç”¨å¦‚ä¸‹è„šæœ¬æ„å»ºå¸¦æœ‰ PGO ä¼˜åŒ–çš„ rustcï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;.&#x2F;x&lt;&#x2F;span&gt;&lt;span&gt; build&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --rust-profile-generate&lt;&#x2F;span&gt;&lt;span&gt;=&#x2F;tmp&#x2F;profiles&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --stage&lt;&#x2F;span&gt;&lt;span&gt; 2 library
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;cargo&lt;&#x2F;span&gt;&lt;span&gt; run&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --bin&lt;&#x2F;span&gt;&lt;span&gt; collector bench_local&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --include&lt;&#x2F;span&gt;&lt;span&gt; serde,syn &amp;lt;path to stage2&#x2F;bin&#x2F;rustc&amp;gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;.&#x2F;build&#x2F;ci-llvm&#x2F;bin&#x2F;llvm-profdata&lt;&#x2F;span&gt;&lt;span&gt; merge&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -o&lt;&#x2F;span&gt;&lt;span&gt; profiles.profdata &#x2F;tmp&#x2F;profiles
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;.&#x2F;x&lt;&#x2F;span&gt;&lt;span&gt; build&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --rust-profile-use&lt;&#x2F;span&gt;&lt;span&gt;=profiles.profdata&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --stage&lt;&#x2F;span&gt;&lt;span&gt; 2 library
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æ¥ä¸‹æ¥ä½¿ç”¨è¯¥ç‰ˆæœ¬ rustc ç¼–è¯‘å¦‚ä¸‹ä»£ç å³å¯å¤ç°è¯¥é—®é¢˜ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;rust&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-rust &quot;&gt;&lt;code class=&quot;language-rust&quot; data-lang=&quot;rust&quot;&gt;&lt;span&gt;#![&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;feature&lt;&#x2F;span&gt;&lt;span&gt;(inline_const)]
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;fn &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fa1b3;&quot;&gt;main&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;const &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;        assert!(-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;9.223372036854776e18&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;f64 &lt;&#x2F;span&gt;&lt;span&gt;as &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;i64 &lt;&#x2F;span&gt;&lt;span&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;0x8000000000000000&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;u64 &lt;&#x2F;span&gt;&lt;span&gt;as &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;i64&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;    }
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å¤ç°çš„é”™è¯¯æ—¥å¿—å¦‚ä¸‹ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;error[E0080]:&lt;&#x2F;span&gt;&lt;span&gt; evaluation of `&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;main::{constant#0&lt;&#x2F;span&gt;&lt;span&gt;}` failed
&lt;&#x2F;span&gt;&lt;span&gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;--&lt;&#x2F;span&gt;&lt;span&gt;&amp;gt; .&#x2F;test.rs:5:9
&lt;&#x2F;span&gt;&lt;span&gt;  |
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;5 &lt;&#x2F;span&gt;&lt;span&gt;|         &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;assert!&lt;&#x2F;span&gt;&lt;span&gt;(-9.223372036854776e18f64 as i64 == 0x8000000000000000u64 as i64);
&lt;&#x2F;span&gt;&lt;span&gt;  |         &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&lt;&#x2F;span&gt;&lt;span&gt; the evaluated program panicked at &amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;assertion failed: -9.223372036854776e18f64 as i64 == 0x8000000000000000u64 as i64&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;, .&#x2F;test.rs:5:9
&lt;&#x2F;span&gt;&lt;span&gt;  |
&lt;&#x2F;span&gt;&lt;span&gt;  = &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;note:&lt;&#x2F;span&gt;&lt;span&gt; this error originates in the macro `&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;assert&lt;&#x2F;span&gt;&lt;span&gt;` (in Nightly builds, run with&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -Z&lt;&#x2F;span&gt;&lt;span&gt; macro-backtrace for more info)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;note:&lt;&#x2F;span&gt;&lt;span&gt; erroneous constant encountered
&lt;&#x2F;span&gt;&lt;span&gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;--&lt;&#x2F;span&gt;&lt;span&gt;&amp;gt; .&#x2F;test.rs:4:5
&lt;&#x2F;span&gt;&lt;span&gt;  |
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;4 &lt;&#x2F;span&gt;&lt;span&gt;| &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span&gt;     const {
&lt;&#x2F;span&gt;&lt;span&gt;5 | |         assert!(-9.223372036854776e18f64 as i64 == 0x8000000000000000u64 as i64);
&lt;&#x2F;span&gt;&lt;span&gt;6 | |     }
&lt;&#x2F;span&gt;&lt;span&gt;  | |&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;_____^
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;error:&lt;&#x2F;span&gt;&lt;span&gt; aborting due to previous error
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;For&lt;&#x2F;span&gt;&lt;span&gt; more information about this error, try `&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;rustc --explain&lt;&#x2F;span&gt;&lt;span&gt; E0080`.
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h1 id=&quot;zuo-yi-xie-chu-bu-de-fen-xi&quot;&gt;åšä¸€äº›åˆæ­¥çš„åˆ†æ&lt;&#x2F;h1&gt;
&lt;h2 id=&quot;shi-yong-cuo-wu-dui-zhan-pan-duan-cun-zai-wen-ti-de-crate&quot;&gt;ä½¿ç”¨é”™è¯¯å †æ ˆåˆ¤æ–­å­˜åœ¨é—®é¢˜çš„ crate&lt;&#x2F;h2&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;-Z treat-err-as-bug&lt;&#x2F;code&gt; è·å–æŠ¥é”™å †æ ˆï¼Œè¢«é”™è¯¯ç¼–è¯‘çš„å‡½æ•°å¾ˆå¯èƒ½åœ¨è¿™é‡Œã€‚&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;â€º&lt;&#x2F;span&gt;&lt;span&gt; .&#x2F;build&#x2F;host&#x2F;stage2&#x2F;bin&#x2F;rustc .&#x2F;test.rs&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -Z&lt;&#x2F;span&gt;&lt;span&gt; treat-err-as-bug
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;error[E0080]:&lt;&#x2F;span&gt;&lt;span&gt; evaluation of `&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;main::{constant#0&lt;&#x2F;span&gt;&lt;span&gt;}` failed
&lt;&#x2F;span&gt;&lt;span&gt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;--&lt;&#x2F;span&gt;&lt;span&gt;&amp;gt; .&#x2F;test.rs:5:9
&lt;&#x2F;span&gt;&lt;span&gt;  |
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;5 &lt;&#x2F;span&gt;&lt;span&gt;|         &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;assert!&lt;&#x2F;span&gt;&lt;span&gt;(-9.223372036854776e18f64 as i64 == 0x8000000000000000u64 as i64);
&lt;&#x2F;span&gt;&lt;span&gt;  |         &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^&lt;&#x2F;span&gt;&lt;span&gt; the evaluated program panicked at &amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;assertion failed: -9.223372036854776e18f64 as i64 == 0x8000000000000000u64 as i64&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;, .&#x2F;test.rs:5:9
&lt;&#x2F;span&gt;&lt;span&gt;  |
&lt;&#x2F;span&gt;&lt;span&gt;  = &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;note:&lt;&#x2F;span&gt;&lt;span&gt; this error originates in the macro `&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;assert&lt;&#x2F;span&gt;&lt;span&gt;` (in Nightly builds, run with&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; -Z&lt;&#x2F;span&gt;&lt;span&gt; macro-backtrace for more info)
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;thread &lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;rustc&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39; panicked at compiler&#x2F;rustc_errors&#x2F;src&#x2F;lib.rs:1724:30:
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;aborting&lt;&#x2F;span&gt;&lt;span&gt; due to `&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;-Z&lt;&#x2F;span&gt;&lt;span&gt; treat-err-as-bug=1`
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;stack&lt;&#x2F;span&gt;&lt;span&gt; backtrace:
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;...
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;23:&lt;&#x2F;span&gt;&lt;span&gt;     0x7f32189f3bd7 - rustc_const_eval&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;[&lt;&#x2F;span&gt;&lt;span&gt;7551efff2730a760&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;]&lt;&#x2F;span&gt;&lt;span&gt;::const_eval::eval_queries::eval_to_const_value_raw_provider
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;...
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;é€šè¿‡è§‚å¯Ÿå †æ ˆï¼Œæˆ‘è®¤ä¸º &lt;code&gt;rustc_const_eval&lt;&#x2F;code&gt; æ˜¯å€¼å¾—å…³æ³¨çš„ crateã€‚æˆ‘ä»¬å¯ä»¥åšä¸ªç®€å•çš„éªŒè¯æ¥è¯æ˜æˆ‘çŒœæµ‹ã€‚ä¿®æ”¹ &lt;code&gt;Cargo.toml&lt;&#x2F;code&gt; ä¸ºå¦‚ä¸‹å†…å®¹ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;toml&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-toml &quot;&gt;&lt;code class=&quot;language-toml&quot; data-lang=&quot;toml&quot;&gt;&lt;span&gt;[profile.release.package.rustc_const_eval]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;codegen-units &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;16
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥å‘ç°é—®é¢˜ä¸å†å¤ç°ã€‚æˆ‘è®¤ä¸ºæ˜¯ stage1 çš„ rustc é”™è¯¯ç¼–è¯‘äº† &lt;code&gt;rustc_const_eval&lt;&#x2F;code&gt;ã€‚&lt;&#x2F;p&gt;
&lt;h2 id=&quot;jian-hua-test-rs&quot;&gt;ç®€åŒ– &lt;code&gt;test.rs&lt;&#x2F;code&gt;&lt;&#x2F;h2&gt;
&lt;p&gt;ç»è¿‡ä¸€äº›å¯¹å¤ç°ç”¨ä¾‹çš„è°ƒæ•´ï¼Œæˆ‘å‘ç°å¦‚ä¸‹ä»£ç ä¹Ÿå¯ä»¥å¤ç°ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;rust&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-rust &quot;&gt;&lt;code class=&quot;language-rust&quot; data-lang=&quot;rust&quot;&gt;&lt;span&gt;#![&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;crate_type &lt;&#x2F;span&gt;&lt;span&gt;= &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;lib&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;]
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;const &lt;&#x2F;span&gt;&lt;span&gt;_: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;u32 &lt;&#x2F;span&gt;&lt;span&gt;= -&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1.1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;f32 &lt;&#x2F;span&gt;&lt;span&gt;as &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;i32 &lt;&#x2F;span&gt;&lt;span&gt;as &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;u32 &lt;&#x2F;span&gt;&lt;span&gt;- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1 &lt;&#x2F;span&gt;&lt;span&gt;as &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;u32&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;åŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œè¿™é‡Œçš„é—®é¢˜è¡¨ç°æ˜¯ä»»æ„ä¸€ä¸ªè´Ÿæµ®ç‚¹æ•°è½¬æ¢ä¸ºæœ‰ç¬¦å·æ•´æ•°éƒ½ä¼šç›´æ¥å˜æˆ 0ã€‚&lt;&#x2F;p&gt;
&lt;h2 id=&quot;da-zhi-ding-wei-wen-ti-han-shu&quot;&gt;å¤§è‡´å®šä½é—®é¢˜å‡½æ•°&lt;&#x2F;h2&gt;
&lt;p&gt;é€šè¿‡é˜…è¯» &lt;code&gt;rustc_const_eval&lt;&#x2F;code&gt; ä»£ç å’Œåˆ†æè°ƒç”¨å †æ ˆï¼Œæˆ‘çŒœæµ‹é—®é¢˜å‡ºåœ¨ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;blob&#x2F;085acd02d4abaf2ccaf629134caa83cfe23283c8&#x2F;compiler&#x2F;rustc_const_eval&#x2F;src&#x2F;interpret&#x2F;cast.rs#L183&quot;&gt;float_to_float_or_int&lt;&#x2F;a&gt; å’Œ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;rust-lang&#x2F;rust&#x2F;blob&#x2F;085acd02d4abaf2ccaf629134caa83cfe23283c8&#x2F;compiler&#x2F;rustc_const_eval&#x2F;src&#x2F;interpret&#x2F;cast.rs#L309&quot;&gt;cast_from_float&lt;&#x2F;a&gt; é™„è¿‘ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;ä¸ºäº†éªŒè¯è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;#[inline(never)]&lt;&#x2F;code&gt; é˜»æ­¢éƒ¨åˆ†ä¼˜åŒ–ã€‚æˆ‘é€šè¿‡å°è¯•å‘ç°ï¼Œæ·»åŠ  &lt;code&gt;#[inline(never)]&lt;&#x2F;code&gt; åˆ° &lt;code&gt;float_to_float_or_int&lt;&#x2F;code&gt; ä»ç„¶æœ‰é—®é¢˜ï¼Œè€Œæ·»åŠ åˆ° &lt;code&gt;cast_from_float&lt;&#x2F;code&gt; åï¼Œæµ‹è¯•ä»£ç å¯ä»¥æ­£å¸¸ç¼–è¯‘ã€‚æˆ‘çŒœæµ‹é—®é¢˜å‡ºç°åœ¨ &lt;code&gt;float_to_float_or_int&lt;&#x2F;code&gt; å’Œå†…è”çš„å‡½æ•° &lt;code&gt;cast_from_float&lt;&#x2F;code&gt; ä¸­ã€‚&lt;&#x2F;p&gt;
&lt;h2 id=&quot;zhen-de-he-pgo-you-guan-ma&quot;&gt;çœŸçš„å’Œ PGO æœ‰å…³å—ï¼Ÿ&lt;&#x2F;h2&gt;
&lt;p&gt;äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ç”¨äºç”Ÿæˆ PGO çš„ stage2 ç‰ˆæœ¬ rustc å¤ç°è¯¥é—®é¢˜ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;.&#x2F;x&lt;&#x2F;span&gt;&lt;span&gt; build&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --rust-profile-generate&lt;&#x2F;span&gt;&lt;span&gt;=&#x2F;tmp&#x2F;profiles&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --stage&lt;&#x2F;span&gt;&lt;span&gt; 2 library
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h1 id=&quot;shi-yong-git-bisect-xun-zhao-shi-na-ge-ti-jiao-hong-fa-liao-zhe-ge-wen-ti&quot;&gt;ä½¿ç”¨ git bisect å¯»æ‰¾æ˜¯å“ªä¸ªæäº¤è§¦å‘äº†è¿™ä¸ªé—®é¢˜&lt;&#x2F;h1&gt;
&lt;p&gt;å°½ç®¡è¿™ä¸€ç»“æœæœªå¿…æ˜¯æœ‰é—®é¢˜çš„æäº¤ï¼Œä½†å®ƒå¯ä»¥ç»™æˆ‘ä»¬æä¾›ä¸€ä¸ªå…·ä½“çš„æ§åˆ¶é”™è¯¯ç¼–è¯‘çš„æ–¹å¼ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒæ•´è¿™ä¸ªæäº¤è¿›ä¸€æ­¥å®šä½é—®é¢˜ã€‚&lt;&#x2F;p&gt;
&lt;h2 id=&quot;xuan-qu-yi-ge-hao-de-ti-jiao&quot;&gt;é€‰å–ä¸€ä¸ªå¥½çš„æäº¤&lt;&#x2F;h2&gt;
&lt;p&gt;ä¸ºäº†æ‰§è¡Œ git bisectï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªå¥½çš„æäº¤ã€‚
å¦‚æœæˆ‘ä»¬ä¸èƒ½åœ¨ä¸€ä¸ªå¤§ç‰ˆæœ¬ä¹‹é—´æ‰¾åˆ°ä¸€ä¸ªå¥½çš„æäº¤ï¼Œæˆ‘ä¼šæ”¾å¼ƒä½¿ç”¨ git bisectã€‚å› ä¸ºå¤ªä¹…è¿œçš„æäº¤å¯èƒ½æ²¡æœ‰æ„ä¹‰ã€‚è€Œä¸”éšç€æˆ‘ä»¬å¿½ç•¥çš„æäº¤è¶Šå¤šï¼Œè¶Šå¯èƒ½å‡ºç°å…¶ä»–ä¸ç›¸å…³çš„é—®é¢˜ã€‚
è¿™é‡Œæˆ‘æœ‰ä¸€ä¸ªç®€å•çš„é€‰æ‹©æ–¹å¼ã€‚LLVM çš„ tag æœ‰ä¸€ä¸ªåˆ›å»ºè§„åˆ™ï¼Œæˆ‘ä»¬åœ¨åˆ›å»ºæ–°çš„ release åˆ†æ”¯æ—¶ï¼ŒåŒæ—¶åˆ›å»ºä¸€ä¸ªæé«˜å¤§ç‰ˆæœ¬çš„ tagï¼Œè¿™ä¸ª tag è§„åˆ™ä¸º &lt;code&gt;llvmorg-{version}-init&lt;&#x2F;code&gt;ï¼Œè¿™ç±» tag çš„å…³ç³»æ˜¯çº¿æ€§çš„ï¼Œå¯¹äº bisect éå¸¸å‹å¥½ã€‚
æˆ‘ä¼šæŠŠ &lt;code&gt;llvmorg-18-init&lt;&#x2F;code&gt; å’Œ &lt;code&gt;llvmorg-17.0.1&lt;&#x2F;code&gt; å½“ä½œä¸€è‡´çš„ä»£ç ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬é€‰æ‹©çš„å¯¹æ¯”ç‰ˆæœ¬ä¸ºï¼š&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;å¥½çš„æäº¤: &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;commit&#x2F;b0daacf58f417634f7c7c9496589d723592a8f5a&quot;&gt;b0daacf5&lt;&#x2F;a&gt;ï¼Œè¿™æ˜¯ &lt;code&gt;llvmorg-17-init&lt;&#x2F;code&gt; çš„å‰ä¸€ä¸ªæäº¤ï¼Œå’Œ &lt;code&gt;llvmorg-16.0.0&lt;&#x2F;code&gt; ç›¸ä¼¼ã€‚ç”±äº rust ä½¿ç”¨ç‰ˆæœ¬å·é€‚é… LLVM çš„ API å˜æ›´ï¼Œæˆ‘ä»¬éœ€è¦ä¿æŒå’Œ API ä¸€è‡´çš„ç‰ˆæœ¬å·ã€‚&lt;&#x2F;li&gt;
&lt;li&gt;åçš„æäº¤: &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;commit&#x2F;d0b54bb50e5110a004b41fc06dadf3fee70834b7&quot;&gt;d0b54bb5&lt;&#x2F;a&gt;ã€‚&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;zhun-bei-llvm-de-gou-jian-pei-zhi&quot;&gt;å‡†å¤‡ LLVM çš„æ„å»ºé…ç½®&lt;&#x2F;h2&gt;
&lt;p&gt;ç”±äºæ¯ä¸€æ­¥çš„ bisect è¦èŠ±å¾ˆé•¿æ—¶é—´ï¼Œé¦–å…ˆæˆ‘æ¨èä½¿ç”¨æ›´é«˜æ€§èƒ½çš„è®¡ç®—æœºç¼©çŸ­è¿™ä¸ªæ—¶é—´ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;ç„¶åä¿®æ”¹ &lt;code&gt;config.toml&lt;&#x2F;code&gt; å‡å°‘é‡å¤æ„å»ºæ—¶é—´ï¼Œæˆ‘çš„ä¿®æ”¹å¦‚ä¸‹ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;toml&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-toml &quot;&gt;&lt;code class=&quot;language-toml&quot; data-lang=&quot;toml&quot;&gt;&lt;span&gt;[build]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;submodules &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;[llvm]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;download-ci-llvm &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;assertions &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;ccache &lt;&#x2F;span&gt;&lt;span&gt;= &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;sccache&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;targets &lt;&#x2F;span&gt;&lt;span&gt;= &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;X86&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;experimental-targets &lt;&#x2F;span&gt;&lt;span&gt;= &amp;quot;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;[target.x86_64-unknown-linux-gnu]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#65737e;&quot;&gt;# ä½¿ç”¨ bisect å patch çš„ commit ä¼šè¢«ç§»é™¤
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;llvm-has-rust-patches &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;[rust]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;codegen-units &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;256
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;åŒæ—¶ä¿®æ”¹ &lt;code&gt;Cargo.toml&lt;&#x2F;code&gt;ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;toml&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-toml &quot;&gt;&lt;code class=&quot;language-toml&quot; data-lang=&quot;toml&quot;&gt;&lt;span&gt;[profile.release.package.rustc_const_eval]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;codegen-units &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;jian-shao-pgo-chu-li-de-han-shu&quot;&gt;å‡å°‘ PGO å¤„ç†çš„å‡½æ•°&lt;&#x2F;h2&gt;
&lt;p&gt;è¿™å³å¯ä»¥å‡å°‘æ„å»ºæ—¶é—´ï¼Œä¹Ÿå¯ä»¥è¿›ä¸€æ­¥æ˜ç¡®é—®é¢˜æ‰€åœ¨ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æˆ‘ä»¬ä¿®æ”¹ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;blob&#x2F;llvmorg-17.0.2&#x2F;llvm&#x2F;lib&#x2F;Transforms&#x2F;Instrumentation&#x2F;PGOInstrumentation.cpp#L1761&quot;&gt;PGOInstrumentation.cpp#L1761&lt;&#x2F;a&gt; çš„è¿‡æ»¤è§„åˆ™ï¼Œæ¯”å¦‚ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;cpp&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-cpp &quot;&gt;&lt;code class=&quot;language-cpp&quot; data-lang=&quot;cpp&quot;&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;static bool &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fa1b3;&quot;&gt;skipPGO&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;const&lt;&#x2F;span&gt;&lt;span&gt; Function &amp;amp;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;F&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#65737e;&quot;&gt;&#x2F;&#x2F; ...
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(!F.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;getName&lt;&#x2F;span&gt;&lt;span&gt;().&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;contains&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;rustc_const_eval&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;))
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(!F.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;getName&lt;&#x2F;span&gt;&lt;span&gt;().&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;contains&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;float_to_float_or_int&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;))
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(!F.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;getName&lt;&#x2F;span&gt;&lt;span&gt;().&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;contains&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;cast_from_float&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;))
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#65737e;&quot;&gt;&#x2F;&#x2F; ...
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;zhi-xing-git-bisect&quot;&gt;æ‰§è¡Œ git bisect&lt;&#x2F;h2&gt;
&lt;p&gt;å’Œæ ‡å‡†çš„ LLVM å·¥ç¨‹çš„ bisect è¿‡ç¨‹æœ‰äº›ä¸åŒã€‚å½“é‡åˆ° &lt;code&gt;PassWrapper.cpp&lt;&#x2F;code&gt; ç¼–è¯‘å¤±è´¥æ—¶ï¼Œæˆ‘ä»¬éœ€è¦æ‰‹åŠ¨é€‚é… API å˜æ›´ã€‚è€Œä¸æ˜¯ä½¿ç”¨ &lt;code&gt;git bisect skip&lt;&#x2F;code&gt;ã€‚
ç”±äºè¦é¢‘ç¹ä¿®æ”¹ &lt;code&gt;PassWrapper.cpp&lt;&#x2F;code&gt;ï¼Œæˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ &lt;code&gt;git bisect run&lt;&#x2F;code&gt; è‡ªåŠ¨å®Œæˆè¿™ä¸€è¿‡ç¨‹ï¼Œåªèƒ½æ‰‹åŠ¨æ‰§è¡Œå¹¶æ£€æŸ¥æ¯æ¬¡çš„ç»“æœã€‚è¿æ°”å¥½çš„è¯ï¼Œä¸è¶…è¿‡ 12 æ¬¡å°±å¯ä»¥å¾—åˆ°ç»“æœã€‚&lt;&#x2F;p&gt;
&lt;p&gt;ç»è¿‡ä¸€æ®µæ—¶é—´çš„è¿è¡Œï¼Œæˆ‘è·å¾—çš„ bisect ç»“æœæ˜¯ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;commit&#x2F;361464c027239a70d66fb7790032b23696d5b303&quot;&gt;361464c0&lt;&#x2F;a&gt;ã€‚
ç”±äº LLVM éå¸¸å¤æ‚ï¼Œæˆ‘è¿˜ä¸€èˆ¬ä¸èƒ½ç›´æ¥ä»è¿™ä¸€æäº¤ä¸­åˆ¤æ–­é—®é¢˜æ‰€åœ¨ï¼ŒåŒæ—¶è¿™ä¸ªæäº¤æœªå¿…æ˜¯æœ‰é—®é¢˜çš„æäº¤ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æˆ‘ä¸€èˆ¬å°† bisect ç»“æœåˆ†ä¸ºå‡ ç±»ï¼š&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;è¿™æ˜¯ä¸€ä¸ªå¯¼è‡´é”™è¯¯ç¼–è¯‘å‘ç”Ÿçš„ç‹¬ç«‹ commit&lt;&#x2F;li&gt;
&lt;li&gt;æäº¤äº†ä¸€äº›è¯¯å¯¼ä¿¡æ¯ï¼Œå¯¼è‡´åé¢çš„ Pass äº§ç”Ÿäº†â€œé”™è¯¯â€ç¼–è¯‘ï¼ˆè¿™æ˜¯ç¬¬ä¸€ä¸ªé—®é¢˜çš„ç±»å‹ï¼‰&lt;&#x2F;li&gt;
&lt;li&gt;åªæ˜¯å·§åˆï¼Œä¸ºåé¢çš„é”™è¯¯ç¼–è¯‘çš„ Pass æä¾›äº†åŒ¹é…çš„è¾“å…¥æˆ–è€…æ˜¯æš´éœ²äº†å·²æœ‰çš„é”™è¯¯ç¼–è¯‘ï¼ˆè¿™æ˜¯ç¬¬äºŒä¸ªé—®é¢˜çš„ç±»å‹ï¼‰&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;ä¸è¿‡æ­¤æ—¶æˆ‘ä»¬è¿˜æ— æ³•ç»™è¿™æ¬¡çš„ç»“æœè¿›è¡Œåˆ†ç±»ã€‚ä½†æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªç»“æœç»§ç»­è°ƒè¯•å®šä½ã€‚&lt;&#x2F;p&gt;
&lt;h1 id=&quot;tong-guo-xiu-gai-llvm-yuan-ma-ding-wei-gan-xing-qu-de-zhuan-huan&quot;&gt;é€šè¿‡ä¿®æ”¹ LLVM æºç å®šä½æ„Ÿå…´è¶£çš„è½¬æ¢&lt;&#x2F;h1&gt;
&lt;p&gt;æ­¤æ—¶æˆ‘ä»¬ä¸çŸ¥é“é”™è¯¯ç¼–è¯‘åœ¨å“ªé‡Œï¼Œæˆ‘ä»¬æ— æ³•é€šè¿‡ç›´æ¥è·å–ä¸€ä¸ª IR è°ƒè¯•ã€‚åœ¨æœ‰æ˜ç¡®çš„ç»“è®ºå‰ï¼Œæˆ‘ä»¬ä»ç„¶ç¼–è¯‘è¿è¡Œ rustc å®šä½é—®é¢˜ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æ ¹æ® bisect ç»“æœï¼Œ&lt;strong&gt;æˆ‘ä»¬éœ€è¦æ‰¾åˆ°æ˜¯å“ªä¸ªå‡½æ•°ç»è¿‡ &lt;code&gt;processImmutArgument&lt;&#x2F;code&gt; åï¼Œæœ€ç»ˆå‡ºç°é”™è¯¯ç¼–è¯‘ã€‚&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;ä½¿ç”¨ç±»ä¼¼ä¸‹é¢çš„ä»£ç å¯ä»¥å¸®åŠ©æˆ‘ä»¬é€æ­¥å®šä½å“ªä¸ªå‡½æ•°è¢«å½±å“äº†ã€‚&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;cpp&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-cpp &quot;&gt;&lt;code class=&quot;language-cpp&quot; data-lang=&quot;cpp&quot;&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;bool &lt;&#x2F;span&gt;&lt;span&gt;MemCpyOptPass::&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fa1b3;&quot;&gt;processImmutArgument&lt;&#x2F;span&gt;&lt;span&gt;(CallBase &amp;amp;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;CB&lt;&#x2F;span&gt;&lt;span&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;unsigned &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;ArgNo&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#65737e;&quot;&gt;&#x2F;&#x2F; ...
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;auto&lt;&#x2F;span&gt;&lt;span&gt; FnName = CB.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;getFunction&lt;&#x2F;span&gt;&lt;span&gt;()-&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;getName&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(FnName.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;contains&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;rustc_const_eval&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;) &amp;amp;&amp;amp;
&lt;&#x2F;span&gt;&lt;span&gt;        FnName.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;contains&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;CompileTimeInterpreter&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;) &amp;amp;&amp;amp;
&lt;&#x2F;span&gt;&lt;span&gt;        FnName.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;contains&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;float_to_float_or_int&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;)) {
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;errs&lt;&#x2F;span&gt;&lt;span&gt;() &amp;lt;&amp;lt; &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;LLVMLOG: Skip &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; &amp;lt;&amp;lt; FnName &amp;lt;&amp;lt; &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;\n&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#65737e;&quot;&gt;&#x2F;&#x2F; ...
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;é€šè¿‡æ—¥å¿—æˆ‘å¯ä»¥å‘ç°åœ¨ &lt;code&gt;MemCpyOptPass&lt;&#x2F;code&gt; ä¸­å½±å“çš„å‡½æ•°æ˜¯ï¼š&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2b303b;color:#c0c5ce;&quot;&gt;&lt;code&gt;&lt;span&gt;&amp;lt;rustc_const_eval::interpret::eval_context::InterpCx&amp;lt;rustc_const_eval::const_eval::machine::CompileTimeInterpreter&amp;gt;&amp;gt;::float_to_float_or_int
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ä»æ—¥å¿—ä¸­æˆ‘å‘ç°è¿™ä¸ªå‡½æ•°å®Œæˆäº†å¤šæ¬¡ &lt;code&gt;memcpy&lt;&#x2F;code&gt; è½¬æ¢ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç»§ç»­è¿‡æ»¤æ‰¾åˆ°æ˜¯å“ªä¸€æ¬¡è½¬æ¢å¯¼è‡´äº†è¿™ä¸ªé—®é¢˜ã€‚&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;cpp&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-cpp &quot;&gt;&lt;code class=&quot;language-cpp&quot; data-lang=&quot;cpp&quot;&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;auto&lt;&#x2F;span&gt;&lt;span&gt; FnName = CB.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;getFunction&lt;&#x2F;span&gt;&lt;span&gt;()-&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;getName&lt;&#x2F;span&gt;&lt;span&gt;();
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;bool&lt;&#x2F;span&gt;&lt;span&gt; IsKeyFunction = FnName.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;contains&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;rustc_const_eval&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;) &amp;amp;&amp;amp;
&lt;&#x2F;span&gt;&lt;span&gt;                     FnName.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;contains&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;CompileTimeInterpreter&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;) &amp;amp;&amp;amp;
&lt;&#x2F;span&gt;&lt;span&gt;                     FnName.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;contains&lt;&#x2F;span&gt;&lt;span&gt;(&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;float_to_float_or_int&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;);
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(!IsKeyFunction)
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;static int&lt;&#x2F;span&gt;&lt;span&gt; Count = &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;Count += &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(Count != &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;errs&lt;&#x2F;span&gt;&lt;span&gt;() &amp;lt;&amp;lt; &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;LLVMLOG: Skip &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; &amp;lt;&amp;lt; Count &amp;lt;&amp;lt; &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;\n&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;errs&lt;&#x2F;span&gt;&lt;span&gt;() &amp;lt;&amp;lt; &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;LLVMLOG: Use &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; &amp;lt;&amp;lt; Count &amp;lt;&amp;lt; &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;\n&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;å½“æˆ‘èµ°åˆ°è¿™ä¸€æ­¥æ—¶ï¼Œæˆ‘å¼€å§‹æ€€ç–‘è¿™æ¬¡é”™è¯¯ç¼–è¯‘å’Œ PGO æ— å…³ã€‚æ­¤æ—¶æˆ‘å°è¯•å–æ¶ˆ PGO ä¹Ÿå¯ä»¥å¤ç°è¯¥é—®é¢˜ã€‚
æˆ‘çŒœæµ‹ PGO åªæ˜¯ä¸€ä¸ªå·§åˆï¼Œå°†è¿™ä¸ªé”™è¯¯ç¼–è¯‘æš´éœ²åˆ°è¿è¡Œæ—¶ã€‚
ä½†æˆ‘ä»¬è¿˜ä¸çŸ¥é“ &lt;code&gt;MemCpyOptPass&lt;&#x2F;code&gt; æ˜¯é‚£ç§ç±»å‹ï¼Œå¯èƒ½æ˜¯æ–°çš„å·§åˆï¼Œä¹Ÿå¯èƒ½æ˜¯é”™è¯¯ç¼–è¯‘ï¼Œæˆ–è€…æ˜¯è¯¯å¯¼äº†åç»­ Passã€‚ &lt;&#x2F;p&gt;
&lt;h2 id=&quot;shi-yong-opt-bisect-limit&quot;&gt;ä½¿ç”¨ &lt;code&gt;-opt-bisect-limit&lt;&#x2F;code&gt;&lt;&#x2F;h2&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;-opt-bisect-limit&lt;&#x2F;code&gt; å®šä½æ˜¯å“ªä¸ª Pass ä¿®æ”¹æŒ‡ä»¤å¯¼è‡´è¿è¡Œæ—¶å‡ºç°é—®é¢˜ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;-opt-bisect-limit&lt;&#x2F;code&gt; å‘ç°çš„ Pass æœ‰ä¸¤ç§ç±»å‹ï¼š&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;å‰é¢çš„ pass æ‰§è¡Œäº†æ­£ç¡®çš„è½¬æ¢ï¼Œä½†æ˜¯æ²¡æœ‰åŠæ—¶æ›´æ–° metadata ç­‰ä¿¡æ¯ï¼Œå¯¼è‡´æ‰¾åˆ°çš„ Pass å‡ºç°é—®é¢˜&lt;&#x2F;li&gt;
&lt;li&gt;æ‰¾åˆ°çš„ Pass æœ¬èº«å­˜åœ¨é”™è¯¯ç¼–è¯‘&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;wei-te-ding-crate-zhi-xing-opt-bisect-limit&quot;&gt;ä¸ºç‰¹å®š crate æ‰§è¡Œ &lt;code&gt;-opt-bisect-limit&lt;&#x2F;code&gt;&lt;&#x2F;h2&gt;
&lt;p&gt;å°æ’æ›²ï¼šæœ¬æ¬¡çœŸå®è°ƒè¯•çš„è¿‡ç¨‹æ˜¯é€šè¿‡ä¿®æ”¹ &lt;code&gt;OptBisect.cpp&lt;&#x2F;code&gt; å®Œæˆçš„ã€‚ä½†åœ¨å†™è¿™ç¯‡æ–‡ç« æ—¶ï¼Œæˆ‘å‘ç°äº†æ›´ç®€å•é«˜æ•ˆçš„æ–¹æ³•ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬ç›´æ¥é€šè¿‡ &lt;code&gt;RUSTFLAGS_NOT_BOOTSTRAP&lt;&#x2F;code&gt; è®¾ç½® &lt;code&gt;-Cllvm-args=-opt-bisect-limit=-1&lt;&#x2F;code&gt; å°†å¾—åˆ°å¤§é‡çš„æ— æ•ˆæ—¥å¿—ã€‚æˆ‘ä»¬å¸Œæœ›åªåº”ç”¨åˆ° &lt;code&gt;rustc_const_eval&lt;&#x2F;code&gt;ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;nightly ç‰ˆæœ¬çš„ &lt;code&gt;cargo&lt;&#x2F;code&gt; æä¾›äº†è¿™ä¸ªåŠŸèƒ½ã€‚æˆ‘ä»¬éœ€è¦å…ˆåˆ‡æ¢åˆ° nightlyã€‚ä¿®æ”¹å¦‚ä¸‹ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;toml&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-toml &quot;&gt;&lt;code class=&quot;language-toml&quot; data-lang=&quot;toml&quot;&gt;&lt;span&gt;[build]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;cargo &lt;&#x2F;span&gt;&lt;span&gt;= &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;&amp;lt;path to home&amp;gt;&#x2F;.rustup&#x2F;toolchains&#x2F;nightly-x86_64-unknown-linux-gnu&#x2F;bin&#x2F;cargo&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ç„¶åæ›´æ–° &lt;code&gt;Cargo.toml&lt;&#x2F;code&gt;ã€‚&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;toml&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-toml &quot;&gt;&lt;code class=&quot;language-toml&quot; data-lang=&quot;toml&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;cargo-features &lt;&#x2F;span&gt;&lt;span&gt;= [&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;profile-rustflags&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#65737e;&quot;&gt;# ...
&lt;&#x2F;span&gt;&lt;span&gt;[profile.release.package.rustc_const_eval]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;rustflags &lt;&#x2F;span&gt;&lt;span&gt;= [
&lt;&#x2F;span&gt;&lt;span&gt;  &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;-C&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;, &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;llvm-args=-opt-bisect-limit=-1&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;,
&lt;&#x2F;span&gt;&lt;span&gt;]
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;--keep-stage&lt;&#x2F;code&gt; æ„å»ºï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;.&#x2F;x&lt;&#x2F;span&gt;&lt;span&gt; build&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --stage&lt;&#x2F;span&gt;&lt;span&gt; 2 library&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --keep-stage&lt;&#x2F;span&gt;&lt;span&gt; 0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --keep-stage-std&lt;&#x2F;span&gt;&lt;span&gt; 1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;&amp;gt; build.log
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;.&#x2F;build&#x2F;host&#x2F;stage2&#x2F;bin&#x2F;rustc&lt;&#x2F;span&gt;&lt;span&gt; .&#x2F;test.rs
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æœ€ç»ˆæˆ‘çš„ bisect ç»“æœä¸ºï¼š&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2b303b;color:#c0c5ce;&quot;&gt;&lt;code&gt;&lt;span&gt;BISECT: running pass (560953) MemCpyOptPass on _RNvMNtNtCsiODAygBxQYA_16rustc_const_eval9interpret4castINtNtB4_12eval_context8InterpCxNtNtNtB6_10const_eval7machine22CompileTimeInterpreterE21float_to_float_or_intB6_
&lt;&#x2F;span&gt;&lt;span&gt;BISECT: running pass (560954) DSEPass on _RNvMNtNtCsiODAygBxQYA_16rustc_const_eval9interpret4castINtNtB4_12eval_context8InterpCxNtNtNtB6_10const_eval7machine22CompileTimeInterpreterE21float_to_float_or_intB6_
&lt;&#x2F;span&gt;&lt;span&gt;BISECT: NOT running pass (560955) MoveAutoInitPass on _RNvMNtNtCsiODAygBxQYA_16rustc_const_eval9interpret4castINtNtB4_12eval_context8InterpCxNtNtNtB6_10const_eval7machine22CompileTimeInterpreterE21float_to_float_or_intB6_
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æœ‰ä¸€ä¸ªè®©æˆ‘æ„Ÿè§‰å¥‡æ€ªçš„åœ°æ–¹æ˜¯ï¼Œå¦‚æœæˆ‘è®¾ç½® limit ä¸º &lt;code&gt;560953&lt;&#x2F;code&gt;ï¼Œç»“æœä¸ä¼šåœåˆ° &lt;code&gt;MemCpyOptPass&lt;&#x2F;code&gt;ã€‚è¿™æ˜¯ä¸ªå¥‡æ€ªçš„ç»“æœè®©æœ¬æ¬¡çš„ bisect ç»“æœæœ‰äº›ä¸å¯ä¿¡ã€‚&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2b303b;color:#c0c5ce;&quot;&gt;&lt;code&gt;&lt;span&gt;BISECT: running pass (560953) BDCEPass on _RNvXsg_NtNtCsjGTw0T6X7N4_16rustc_const_eval9interpret7operandNtB5_9ImmediateNtNtCs6sCMhXnFQZh_4core3fmt5Debug3fmtB9_
&lt;&#x2F;span&gt;&lt;span&gt;BISECT: NOT running pass (560954) InstCombinePass on _RNvXsg_NtNtCsjGTw0T6X7N4_16rustc_const_eval9interpret7operandNtB5_9ImmediateNtNtCs6sCMhXnFQZh_4core3fmt5Debug3fmtB9_
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ä¸è¿‡æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç±»ä¼¼çš„æ–¹æ³•éªŒè¯é—®é¢˜æ˜¯å¦ä¸ &lt;code&gt;DSEPass&lt;&#x2F;code&gt; æœ‰å…³ï¼Œé€šè¿‡ä¿®æ”¹ä»£ç è·³è¿‡ &lt;code&gt;DSEPass&lt;&#x2F;code&gt; å³å¯ã€‚
æ¥ä¸‹æ¥å’Œè°ƒè¯• &lt;code&gt;MemCpyOptPass&lt;&#x2F;code&gt; ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å…·ä½“æ˜¯å“ªä¸ªæŒ‡ä»¤ &lt;code&gt;DSEPass&lt;&#x2F;code&gt; è½¬æ¢å¯¼è‡´äº†æœ€ç»ˆçš„é”™è¯¯ç¼–è¯‘ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æ›´æ–°ï¼šä¸ºäº†è®© &lt;code&gt;-opt-bisect-limit&lt;&#x2F;code&gt; çš„ç»“æœæ›´ç¨³å®šï¼Œæˆ‘ä»¬å¯ä»¥è¯•è¯• &lt;code&gt;-Z no-parallel-llvm&lt;&#x2F;code&gt;ã€‚å¦å¤–ï¼Œ&lt;code&gt;rustc&lt;&#x2F;code&gt; é»˜è®¤ä¼šå°è¯•æ‰§è¡Œ ThinLTOï¼Œå¯ä»¥é€šè¿‡ &lt;code&gt;-C lto=false&lt;&#x2F;code&gt; å…³é—­ã€‚&lt;&#x2F;p&gt;
&lt;h1 id=&quot;huo-qu-ir-zhun-bei-llvm-de-diao-shi&quot;&gt;è·å– IR å‡†å¤‡ LLVM çš„è°ƒè¯•&lt;&#x2F;h1&gt;
&lt;p&gt;è¿™éƒ¨åˆ†æ¶‰åŠåˆ° LLVM çš„å…·ä½“è°ƒè¯•ï¼Œæˆ‘æš‚æ—¶è¿˜æ²¡æœ‰ä»€ä¹ˆå¥½çš„ç»éªŒåˆ†äº«ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;ä½†é‡è¦çš„ä¸¤ç‚¹æ˜¯ï¼š&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;æˆ‘ä»¬çŸ¥é“äº†åœ¨ &lt;code&gt;MemCpyOptPass&lt;&#x2F;code&gt; ä¸­ï¼Œå…·ä½“æ˜¯å“ªæ¬¡è½¬æ¢å½±å“äº†ç»“æœ&lt;&#x2F;li&gt;
&lt;li&gt;æˆ‘ä»¬ä¹ŸçŸ¥é“äº†åœ¨ &lt;code&gt;DSEPass&lt;&#x2F;code&gt; ä¸­ï¼Œå…·ä½“æ˜¯å“ªæ¬¡è½¬æ¢å¯¼è‡´äº†æœ€ç»ˆçš„é”™è¯¯ç¼–è¯‘&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;é€šè¿‡è¿™ä¸¤æ­¤è½¬æ¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ &lt;code&gt;opt&lt;&#x2F;code&gt; è°ƒè¯• IR äº†ã€‚æˆ‘ä»¬ä¸éœ€è¦å†ä½¿ç”¨ &lt;code&gt;rustc&lt;&#x2F;code&gt; é¢‘ç¹ç¼–è¯‘äº†ï¼&lt;&#x2F;p&gt;
&lt;p&gt;å¯¹äºè·å– IR çš„æ–¹å¼æˆ‘æ¨èé€šè¿‡ä¿®æ”¹ &lt;code&gt;Cargo.toml&lt;&#x2F;code&gt; è·å¾—ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;toml&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-toml &quot;&gt;&lt;code class=&quot;language-toml&quot; data-lang=&quot;toml&quot;&gt;&lt;span&gt;[profile.release.package.rustc_const_eval]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;codegen-units &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;rustflags &lt;&#x2F;span&gt;&lt;span&gt;= [
&lt;&#x2F;span&gt;&lt;span&gt;  &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;-C&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;, &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;save-temps&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;,
&lt;&#x2F;span&gt;&lt;span&gt;]
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ç„¶åæ‰¾åˆ° &lt;code&gt;*.no-opt.bc&lt;&#x2F;code&gt; è¿›è¡Œè°ƒè¯•ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;å½“ç„¶åœ¨è¿™ä¸ªè°ƒè¯•è¿‡ç¨‹ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ &lt;code&gt;MemCpyOptPass&lt;&#x2F;code&gt; å’Œ &lt;code&gt;DSEPass&lt;&#x2F;code&gt; çš„å…·ä½“ä¸¤ä¸ªè½¬æ¢çš„é€»è¾‘ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬ä¼šäº†è§£åˆ°è¿™æ˜¯é€šè¿‡åˆ«ååˆ†æè¿›è¡Œçš„è½¬æ¢ï¼Œæœ€ç»ˆå®šä½åˆ° &lt;code&gt;MemCpyOptPass&lt;&#x2F;code&gt; åœ¨æ›¿æ¢æŒ‡ä»¤ä½¿ç”¨çš„å€¼æ—¶ï¼Œæ²¡æœ‰æ›´æ–°å¯¹åº”çš„åˆ«åä¿¡æ¯ã€‚&lt;&#x2F;p&gt;
&lt;h1 id=&quot;xia-yi-ge-wen-ti-mir-niche-checks&quot;&gt;ä¸‹ä¸€ä¸ªé—®é¢˜ - mir niche checks&lt;&#x2F;h1&gt;
&lt;p&gt;å°½ç®¡è¿™ä¸ªé—®é¢˜çš„å¤ç°æ¯”å‰è€…è¦ç®€å•ï¼Œä½†å®šä½èµ·æ¥ä¼šæ›´éº»çƒ¦ã€‚
é¦–å…ˆè®©æˆ‘ä»¬åˆ‡æ¢åˆ° &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;DianQK&#x2F;rust&#x2F;commit&#x2F;cf8d85e49c6f3a5802549055f983fd0ba3f89952&quot;&gt;cf8d85e4&lt;&#x2F;a&gt;ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;ä½¿ç”¨ &lt;code&gt;--stage 2&lt;&#x2F;code&gt; æ‰§è¡Œæµ‹è¯•å³å¯å¤ç°ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;.&#x2F;x&lt;&#x2F;span&gt;&lt;span&gt; test tests&#x2F;ui&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --stage&lt;&#x2F;span&gt;&lt;span&gt; 2
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;code&gt;config.toml&lt;&#x2F;code&gt; å‚è€ƒï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;toml&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-toml &quot;&gt;&lt;code class=&quot;language-toml&quot; data-lang=&quot;toml&quot;&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;profile &lt;&#x2F;span&gt;&lt;span&gt;= &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;codegen&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;[llvm]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;assertions &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;enable-warnings &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;download-ci-llvm &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;ccache &lt;&#x2F;span&gt;&lt;span&gt;= &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;sccache&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;targets &lt;&#x2F;span&gt;&lt;span&gt;= &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;X86&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;experimental-targets &lt;&#x2F;span&gt;&lt;span&gt;= &amp;quot;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;link-shared &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;true
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;use-linker &lt;&#x2F;span&gt;&lt;span&gt;= &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;lld&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;optimize &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;true
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;release-debuginfo &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;true
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;[rust]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;debug &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;incremental &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;optimize &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;3
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;debug-logging &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;deny-warnings &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;codegen-backends &lt;&#x2F;span&gt;&lt;span&gt;= [&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;llvm&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;]
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;use-lld &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;true
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;lto &lt;&#x2F;span&gt;&lt;span&gt;= &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;off&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;debug-assertions &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;true
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;debug-assertions-std &lt;&#x2F;span&gt;&lt;span&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;false
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;é”™è¯¯æ—¥å¿—å¦‚ä¸‹ï¼š&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2b303b;color:#c0c5ce;&quot;&gt;&lt;code&gt;&lt;span&gt;thread &amp;#39;rustc&amp;#39; panicked at compiler&#x2F;rustc_mir_build&#x2F;src&#x2F;thir&#x2F;pattern&#x2F;deconstruct_pat.rs:560:22:
&lt;&#x2F;span&gt;&lt;span&gt;occupied niche: found 0x7f7700000000 but must be in 0x0..=0x2 in type std::option::Option&amp;lt;thir::pattern::deconstruct_pat::SliceKind&amp;gt; at offset 0 with type Int(I64, false)
&lt;&#x2F;span&gt;&lt;span&gt;stack backtrace:
&lt;&#x2F;span&gt;&lt;span&gt;  ...
&lt;&#x2F;span&gt;&lt;span&gt;  13:     0x7f77e92ade54 - &amp;lt;rustc_mir_build[48ebee3fe6c2e2b3]::thir::pattern::deconstruct_pat::Constructor&amp;gt;::split::&amp;lt;core[8d828210e7f791ba]::iter::adapters::map::Map&amp;lt;core[8d828210e7f791ba]::iter::adapters::map::Map&amp;lt;core[8d828210e7f791ba]::slice::iter::Iter&amp;lt;rustc_mir_build[48ebee3fe6c2e2b3]::thir::pattern::usefulness::PatStack&amp;gt;, &amp;lt;rustc_mir_build[48ebee3fe6c2e2b3]::thir::pattern::usefulness::Matrix&amp;gt;::heads::{closure#0}&amp;gt;, &amp;lt;rustc_mir_build[48ebee3fe6c2e2b3]::thir::pattern::deconstruct_pat::DeconstructedPat&amp;gt;::ctor&amp;gt;&amp;gt;
&lt;&#x2F;span&gt;&lt;span&gt;  ...
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ‘å‘ç°å¦‚æœè®¾ç½® &lt;code&gt;codegen-units=1&lt;&#x2F;code&gt;ï¼Œè¿™ä¸ª panic å°±ä¼šæ¶ˆå¤±ã€‚
é‚£ä¹ˆæˆ‘ä»¬æ­£å¥½å¯ä»¥å€ŸåŠ© &lt;code&gt;codegen-units&lt;&#x2F;code&gt; åˆ¤æ–­æ˜¯å“ªä¸ª crate è¢«å½±å“äº†ã€‚æ ¹æ®å †æ ˆçŒœæµ‹æ˜¯ &lt;code&gt;rustc_mir_build&lt;&#x2F;code&gt;ï¼Œå°è¯•åˆ‡æ¢ &lt;code&gt;codegen-units=1&lt;&#x2F;code&gt; éªŒè¯ã€‚
ç”±äºè¿™ä¸ªé—®é¢˜å‘ç”Ÿå’Œä¸Šä¸€ä¸ªæ—¶é—´ç‚¹åŸºæœ¬ä¸€è‡´ï¼Œæˆ‘ä»¬ä½¿ç”¨ç›¸åŒçš„ LLVM æäº¤ä½œä¸º bisect å¼€å§‹ã€‚
é—æ†¾çš„æ˜¯ï¼Œå¦‚æœè®¾ç½® &lt;code&gt;optimize=3&lt;&#x2F;code&gt;ï¼Œæˆ‘ä»¬æ— æ³•åœ¨ LLVM 16 æ‰¾åˆ°ä¸€ä¸ªå¥½çš„æäº¤ã€‚ä½†æˆ‘è¿˜å°è¯•äº†è®¾ç½® &lt;code&gt;optimize=2&lt;&#x2F;code&gt; å¯ä»¥æ‰¾åˆ° LLVM 16 æ˜¯å¥½çš„æäº¤ã€‚&lt;&#x2F;p&gt;
&lt;h2 id=&quot;ji-shou-de-git-bisect&quot;&gt;æ£˜æ‰‹çš„ git bisect&lt;&#x2F;h2&gt;
&lt;p&gt;åœ¨ bisect è¿‡ç¨‹ä¸­ï¼Œæˆ‘å¾—åˆ°ä¸€ä¸ªæ„å¤–ç»“æœï¼š&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2b303b;color:#c0c5ce;&quot;&gt;&lt;code&gt;&lt;span&gt;---- [ui] tests&#x2F;ui&#x2F;issue-11881.rs stdout ----
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;error: test compilation failed although it shouldn&amp;#39;t!
&lt;&#x2F;span&gt;&lt;span&gt;status: exit status: 1
&lt;&#x2F;span&gt;&lt;span&gt;command: RUSTC_ICE=&amp;quot;0&amp;quot; &amp;quot;&#x2F;home&#x2F;dianqk&#x2F;rust-workspace&#x2F;rust&#x2F;build&#x2F;x86_64-unknown-linux-gnu&#x2F;stage2&#x2F;bin&#x2F;rustc&amp;quot; &amp;quot;&#x2F;home&#x2F;dianqk&#x2F;rust-workspace&#x2F;rust&#x2F;tests&#x2F;ui&#x2F;issue-11881.rs&amp;quot; &amp;quot;-Zthreads=1&amp;quot; &amp;quot;-Zsimulate-remapped-rust-src-base=&#x2F;rustc&#x2F;FAKE_PREFIX&amp;quot; &amp;quot;-Ztranslate-remapped-path-to-local-path=no&amp;quot; &amp;quot;-Z&amp;quot; &amp;quot;ignore-directory-in-diagnostics-source-blocks=&#x2F;home&#x2F;dianqk&#x2F;.cargo&amp;quot; &amp;quot;--sysroot&amp;quot; &amp;quot;&#x2F;home&#x2F;dianqk&#x2F;rust-workspace&#x2F;rust&#x2F;build&#x2F;x86_64-unknown-linux-gnu&#x2F;stage2&amp;quot; &amp;quot;--target=x86_64-unknown-linux-gnu&amp;quot; &amp;quot;-O&amp;quot; &amp;quot;--error-format&amp;quot; &amp;quot;json&amp;quot; &amp;quot;--json&amp;quot; &amp;quot;future-incompat&amp;quot; &amp;quot;-Ccodegen-units=1&amp;quot; &amp;quot;-Zui-testing&amp;quot; &amp;quot;-Zdeduplicate-diagnostics=no&amp;quot; &amp;quot;-Zwrite-long-types-to-disk=no&amp;quot; &amp;quot;-Cstrip=debuginfo&amp;quot; &amp;quot;-C&amp;quot; &amp;quot;prefer-dynamic&amp;quot; &amp;quot;-o&amp;quot; &amp;quot;&#x2F;home&#x2F;dianqk&#x2F;rust-workspace&#x2F;rust&#x2F;build&#x2F;x86_64-unknown-linux-gnu&#x2F;test&#x2F;ui&#x2F;issue-11881&#x2F;a&amp;quot; &amp;quot;-A&amp;quot; &amp;quot;internal_features&amp;quot; &amp;quot;-Crpath&amp;quot; &amp;quot;-Cdebuginfo=0&amp;quot; &amp;quot;-Lnative=&#x2F;home&#x2F;dianqk&#x2F;rust-workspace&#x2F;rust&#x2F;build&#x2F;x86_64-unknown-linux-gnu&#x2F;native&#x2F;rust-test-helpers&amp;quot; &amp;quot;-Clink-arg=-fuse-ld=lld&amp;quot; &amp;quot;-Clink-arg=-Wl,--threads=1&amp;quot; &amp;quot;-L&amp;quot; &amp;quot;&#x2F;home&#x2F;dianqk&#x2F;rust-workspace&#x2F;rust&#x2F;build&#x2F;x86_64-unknown-linux-gnu&#x2F;test&#x2F;ui&#x2F;issue-11881&#x2F;auxiliary&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;stdout: none
&lt;&#x2F;span&gt;&lt;span&gt;--- stderr -------------------------------
&lt;&#x2F;span&gt;&lt;span&gt;error: unexpected token: `&amp;amp;`
&lt;&#x2F;span&gt;&lt;span&gt;  --&amp;gt; &#x2F;home&#x2F;dianqk&#x2F;rust-workspace&#x2F;rust&#x2F;tests&#x2F;ui&#x2F;issue-11881.rs:18:25
&lt;&#x2F;span&gt;&lt;span&gt;   |
&lt;&#x2F;span&gt;&lt;span&gt;LL |     fn encode(&amp;amp;self, s: &amp;amp;mut S) -&amp;gt; Result&amp;lt;(), S::Error&amp;gt;;
&lt;&#x2F;span&gt;&lt;span&gt;   |                         ^ unexpected token after this
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;error: unexpected token: `&amp;amp;`
&lt;&#x2F;span&gt;&lt;span&gt;  --&amp;gt; &#x2F;home&#x2F;dianqk&#x2F;rust-workspace&#x2F;rust&#x2F;tests&#x2F;ui&#x2F;issue-11881.rs:33:23
&lt;&#x2F;span&gt;&lt;span&gt;   |
&lt;&#x2F;span&gt;&lt;span&gt;LL |     fn fmt(&amp;amp;self, _f: &amp;amp;mut fmt::Formatter&amp;lt;&amp;#39;_&amp;gt;) -&amp;gt; fmt::Result {
&lt;&#x2F;span&gt;&lt;span&gt;   |                       ^ unexpected token after this
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;é¢å¯¹è¿™ä¸ªç»“æœï¼Œæˆ‘ä»¬ä¸å¯ä½¿ç”¨ good&#x2F;bad æ‰§è¡Œ bisectï¼Œè¿™å°† bisect å¯¼å‘é”™è¯¯çš„ç»“æœã€‚&lt;&#x2F;p&gt;
&lt;p&gt;é—æ†¾çš„æ˜¯ï¼Œå³ä¾¿ä½¿ç”¨ skipï¼Œæˆ‘ä»¬ä¹Ÿæ— æ³•å¾—åˆ° bisect ç»“æœã€‚
å½“ bisect åœ¨ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;llvm&#x2F;llvm-project&#x2F;compare&#x2F;f7deb69f22b93d7411d08db14b50aae5caf40fcb...7c78cb4b1f4993a84bf2b46b197d90dcabb9f8c5&quot;&gt;f7deb69f2...7c78cb4b&lt;&#x2F;a&gt; å†…éƒ¨æ—¶ï¼Œå°±å¯ä»¥å¾—åˆ°è¿™ä¸ªé¢„æœŸä¹‹å¤–çš„é”™è¯¯ã€‚å¦‚æœæ˜¯æ›´æ—©çš„æäº¤ï¼Œæ˜¯ goodï¼Œæ›´æ™šçš„æäº¤ï¼Œæ˜¯ badã€‚
è¿™æ˜¯å› ä¸º &lt;code&gt;nonnull&lt;&#x2F;code&gt; ç­‰è¯­ä¹‰çš„å˜æ›´åå¼•å…¥äº†æ–°çš„é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨ bisect æœŸé—´å¿½ç•¥äº†ä¸€äº›é—®é¢˜ä¿®å¤ï¼Œå¯¼è‡´æš´éœ²äº†ä¸€ä¸ªæ–°çš„é—®é¢˜ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æ­¤å¤„æäº¤å†å²å¦‚ä¸‹ï¼š&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2b303b;color:#c0c5ce;&quot;&gt;&lt;code&gt;&lt;span&gt;bad
&lt;&#x2F;span&gt;&lt;span&gt;Revert &amp;quot;[SimplifyCFG][LICM] Preserve nonnull, range and align metadatâ€¦  7c78cb4
&lt;&#x2F;span&gt;&lt;span&gt;skip
&lt;&#x2F;span&gt;&lt;span&gt;[SimplifyCFG][LICM] Preserve nonnull, range and align metadata when sâ€¦  78b1fbc
&lt;&#x2F;span&gt;&lt;span&gt;good
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ç”±äºæˆ‘ä»¬å¿½ç•¥äº†ä¸€äº›æäº¤å¯¼è‡´æ–°é—®é¢˜å‘ç”Ÿï¼Œbisect æ²¡æœ‰ç»“æœã€‚
å¹¸è¿çš„æ˜¯ï¼Œè¿™æ¬¡çš„é—®é¢˜å¾ˆç‰¹åˆ«çš„ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ rebase å°† &lt;code&gt;78b1fbc&lt;&#x2F;code&gt; å’Œ &lt;code&gt;7c78cb4&lt;&#x2F;code&gt; drop æ‰ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æœ€ç»ˆ bisect ç»“æœæ˜¯ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;DianQK&#x2F;llvm-project&#x2F;commit&#x2F;2f70f65246e987842cfae495839975eaa6245a0c&quot;&gt;[AggressiveInstCombine] Enable also for -O2&lt;&#x2F;a&gt;ã€‚
æˆ‘ä¹Ÿé€šè¿‡ä¿®æ”¹ä»£ç æ‰¾åˆ°äº†åœ¨ &lt;code&gt;AggressiveInstCombine&lt;&#x2F;code&gt; çš„å…³é”®è½¬æ¢ï¼Œä½†ä»ä»£ç å’Œ IR ä¸Šï¼Œæˆ‘çœ‹ä¸å‡ºä»€ä¹ˆé—®é¢˜ã€‚å¯èƒ½æ˜¯æˆ‘ç–æ¼äº†ä»€ä¹ˆï¼Œä¹Ÿå¯èƒ½æ˜¯è¿™åªæ˜¯ä¸ªå¹¸è¿çš„è§¦å‘æœºä¼šã€‚
æˆ‘ä»¬éœ€è¦è®°ä½è¿™ä¸ªæ€€ç–‘ç‚¹ï¼Œç»§ç»­æ’æŸ¥ã€‚&lt;&#x2F;p&gt;
&lt;h1 id=&quot;codegen-units-256-opt-bisect-limit-n&quot;&gt;&lt;code&gt;codegen-units=256&lt;&#x2F;code&gt; &amp;amp; &lt;code&gt;-opt-bisect-limit=n&lt;&#x2F;code&gt;&lt;&#x2F;h1&gt;
&lt;p&gt;è¿™æ¬¡æˆ‘ä»¬æ²¡æœ‰åŠæ³•ä½¿ç”¨ &lt;code&gt;-opt-bisect-limit&lt;&#x2F;code&gt;ï¼Œå› ä¸º &lt;code&gt;codegen-units&lt;&#x2F;code&gt; ä¸ç­‰äº 1ã€‚ 
åŒæ—¶å¯¹å¤šä¸ª IR è¿›è¡Œ bisect æ²¡æœ‰æ„ä¹‰ã€‚æˆ‘ä»¬éœ€è¦ä¿®æ”¹ rust ä»£ç æ”¯æŒåœ¨å¤šä¸ª CGU ä¸‹é€‰æ‹©ç‰¹å®šçš„ CGU è¿›è¡Œ bisectã€‚&lt;&#x2F;p&gt;
&lt;p&gt;é¦–å…ˆä½¿ç”¨ &lt;code&gt;-C save-temps&lt;&#x2F;code&gt; æ‰¾åˆ°å¯¹åº”çš„ IRã€‚ä¿®æ”¹æ–¹å¼å‚è€ƒ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;DianQK&#x2F;rust&#x2F;commit&#x2F;bfd759b704b77d0ff390cc172a62c3d9a0c36986&quot;&gt;bfd759b7&lt;&#x2F;a&gt;ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;å°æ’æ›²ï¼šè¿™é‡Œæˆ‘ä¹Ÿå°è¯•äº†åœ¨ AggressiveInstCombine ä¸­å¯»æ‰¾æœ‰å½±å“çš„é‚£ä¸€æ¬¡è½¬æ¢ã€‚å¾ˆå¤´ç—›çš„æ˜¯ï¼Œæ·»åŠ  &lt;code&gt;-C save-temps&lt;&#x2F;code&gt; åï¼Œç¬¦å·åä¼šå˜ï¼Œè¿™è®©æˆ‘é‡æ–°æ‰¾äº†ä¸€ä¸‹æœ‰å…³è”çš„ç¬¦å·ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;æˆ‘ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„è„šæœ¬æ‰¾åˆ°è¿™ä¸ª IRï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;for&lt;&#x2F;span&gt;&lt;span&gt; bitcode &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;in&lt;&#x2F;span&gt;&lt;span&gt; build&#x2F;x86_64-unknown-linux-gnu&#x2F;stage1-rustc&#x2F;x86_64-unknown-linux-gnu&#x2F;release&#x2F;deps&#x2F;rustc_mir_build-*-cgu.*.rcgu.no-opt.bc; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;do
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;llvm-nm -U &lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;bitcode &lt;&#x2F;span&gt;&lt;span&gt;| &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;grep -q &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;example&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;then
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;bitcode
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;fi
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;done
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ‘æŸ¥çœ‹äº† &lt;code&gt;OptBisect&lt;&#x2F;code&gt; çš„å®ç°ï¼Œå°½ç®¡ &lt;code&gt;-opt-bisect-limit&lt;&#x2F;code&gt; å‚æ•°æ˜¯å…¨å±€çš„ï¼Œä½†æˆ‘ä»¬å¯ä»¥ä¸º CGU å•ç‹¬æ›¿æ¢ä¸€ä¸ªç©ºçš„ &lt;code&gt;OptBisect&lt;&#x2F;code&gt;ã€‚å®Œæ•´ä¿®æ”¹åœ¨ &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;DianQK&#x2F;rust&#x2F;commit&#x2F;a9f62a4a634aef8f792e9cb6eb4573b4b9fc79d2&quot;&gt;a9f62a4a&lt;&#x2F;a&gt;ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;ä¸€äº›å…³é”®ä¿®æ”¹å‚è€ƒå¦‚ä¸‹ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;cpp&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-cpp &quot;&gt;&lt;code class=&quot;language-cpp&quot; data-lang=&quot;cpp&quot;&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;struct &lt;&#x2F;span&gt;&lt;span&gt;RunAllOptPassGate : &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;public &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;OptPassGate &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;bool &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fa1b3;&quot;&gt;shouldRunPass&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;const&lt;&#x2F;span&gt;&lt;span&gt; StringRef &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;PassName&lt;&#x2F;span&gt;&lt;span&gt;, StringRef &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;IRDescription&lt;&#x2F;span&gt;&lt;span&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;override &lt;&#x2F;span&gt;&lt;span&gt;{
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;bool &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fa1b3;&quot;&gt;isEnabled&lt;&#x2F;span&gt;&lt;span&gt;() &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;const override &lt;&#x2F;span&gt;&lt;span&gt;{ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;; }
&lt;&#x2F;span&gt;&lt;span&gt;};
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;static&lt;&#x2F;span&gt;&lt;span&gt; RunAllOptPassGate &amp;amp;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fa1b3;&quot;&gt;getRunAllOptPassGate&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;static&lt;&#x2F;span&gt;&lt;span&gt; RunAllOptPassGate RunAllOptPassGate;
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;return&lt;&#x2F;span&gt;&lt;span&gt; RunAllOptPassGate;
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;extern &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;C&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;void &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fa1b3;&quot;&gt;LLVMRustContextSetSetRunAllOptPassGate&lt;&#x2F;span&gt;&lt;span&gt;(LLVMContextRef &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;C&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;unwrap&lt;&#x2F;span&gt;&lt;span&gt;(C)-&amp;gt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;setOptPassGate&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;getRunAllOptPassGate&lt;&#x2F;span&gt;&lt;span&gt;());
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ‘è¿˜å¢åŠ äº†ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•° &lt;code&gt;-Z llvm-opt-bisect-limit-cgu&lt;&#x2F;code&gt;ï¼Œè¿™æ ·æˆ‘å°±å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è„šæœ¬è¿›è¡Œ bisectï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;export &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;RUSTFLAGS_NOT_BOOTSTRAP&lt;&#x2F;span&gt;&lt;span&gt;=&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;-C llvm-args=-opt-bisect-limit=-1 -Z llvm-opt-bisect-limit-cgu=rustc_mir_build.63d28fcded2a05ed-cgu.007&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;.&#x2F;x&lt;&#x2F;span&gt;&lt;span&gt; build&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --stage&lt;&#x2F;span&gt;&lt;span&gt; 2 library&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --keep-stage&lt;&#x2F;span&gt;&lt;span&gt; 0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt; --keep-stage-std&lt;&#x2F;span&gt;&lt;span&gt; 1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;&amp;gt; build.log
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;.&#x2F;build&#x2F;host&#x2F;stage2&#x2F;bin&#x2F;rustc&lt;&#x2F;span&gt;&lt;span&gt; .&#x2F;tests&#x2F;ui&#x2F;consts&#x2F;const_prop_slice_pat_ice.rs
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ‘è¿˜ç¼–å†™äº†ä¸€ä¸ªç®€å•çš„è‡ªåŠ¨ bisect è„šæœ¬ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;bash&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-bash &quot;&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;function &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fa1b3;&quot;&gt;iterate&lt;&#x2F;span&gt;&lt;span&gt;() {
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;local &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;good&lt;&#x2F;span&gt;&lt;span&gt;=`&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sed -n &lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;1p&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39; bisect_result`
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;local &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;bad&lt;&#x2F;span&gt;&lt;span&gt;=`&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sed -n &lt;&#x2F;span&gt;&lt;span&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;2p&lt;&#x2F;span&gt;&lt;span&gt;&amp;#39; bisect_result`
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;local &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;result&lt;&#x2F;span&gt;&lt;span&gt;=$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;((bad &lt;&#x2F;span&gt;&lt;span&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt; good))
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;good: &lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;good&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;, bad: &lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;bad&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;[ &lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;result -eq&lt;&#x2F;span&gt;&lt;span&gt; 1 &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;]&lt;&#x2F;span&gt;&lt;span&gt;; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;then
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;done&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;exit&lt;&#x2F;span&gt;&lt;span&gt; 0
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;else
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;local &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;next&lt;&#x2F;span&gt;&lt;span&gt;=$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;((good &lt;&#x2F;span&gt;&lt;span&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;(result &lt;&#x2F;span&gt;&lt;span&gt;&#x2F; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;)))
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;next
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;bash&lt;&#x2F;span&gt;&lt;span&gt; bisect.sh $&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;next
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;exit_code&lt;&#x2F;span&gt;&lt;span&gt;=$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;?
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;case &lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;exit_code &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;in
&lt;&#x2F;span&gt;&lt;span&gt;            0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;good&lt;&#x2F;span&gt;&lt;span&gt;=$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;next
&lt;&#x2F;span&gt;&lt;span&gt;                ;;
&lt;&#x2F;span&gt;&lt;span&gt;            1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;bad&lt;&#x2F;span&gt;&lt;span&gt;=$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;next
&lt;&#x2F;span&gt;&lt;span&gt;                ;;
&lt;&#x2F;span&gt;&lt;span&gt;            *&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;)
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;failed: &lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;exit_code&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;
&lt;&#x2F;span&gt;&lt;span&gt;                &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;exit&lt;&#x2F;span&gt;&lt;span&gt; 1
&lt;&#x2F;span&gt;&lt;span&gt;                ;;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;esac
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;fi
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;good &lt;&#x2F;span&gt;&lt;span&gt;&amp;gt; bisect_result
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;echo &lt;&#x2F;span&gt;&lt;span&gt;$&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;bad &lt;&#x2F;span&gt;&lt;span&gt;&amp;gt;&amp;gt; bisect_result
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;while &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;do
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;iterate
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;sleep&lt;&#x2F;span&gt;&lt;span&gt; 1
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;done
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ä½†æˆ‘å¾—åˆ°äº†ä¸€ä¸ªå¥‡æ€ªçš„ç»“æœï¼š&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2b303b;color:#c0c5ce;&quot;&gt;&lt;code&gt;&lt;span&gt;ISECT: running pass (13444) InlinerPass on (symbol)
&lt;&#x2F;span&gt;&lt;span&gt;BISECT: NOT running pass (13445) PostOrderFunctionAttrsPass on (symbol)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ‘è®¤ä¸º inline ä¸è¿™ä¸ªé”™è¯¯ç¼–è¯‘æ— ç›´æ¥å…³ç³»ã€‚
æˆ‘ç®€å•åœ°ä¿®æ”¹äº† &lt;code&gt;OptBisect.cpp&lt;&#x2F;code&gt; è·³è¿‡ &lt;code&gt;InlinerPass&lt;&#x2F;code&gt;ï¼š&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;cpp&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-cpp &quot;&gt;&lt;code class=&quot;language-cpp&quot; data-lang=&quot;cpp&quot;&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;bool &lt;&#x2F;span&gt;&lt;span&gt;OptBisect::&lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fa1b3;&quot;&gt;shouldRunPass&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;const&lt;&#x2F;span&gt;&lt;span&gt; StringRef &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;PassName&lt;&#x2F;span&gt;&lt;span&gt;,
&lt;&#x2F;span&gt;&lt;span&gt;                              StringRef &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;IRDescription&lt;&#x2F;span&gt;&lt;span&gt;) {
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;(PassName == &amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#a3be8c;&quot;&gt;InlinerPass&lt;&#x2F;span&gt;&lt;span&gt;&amp;quot;) {
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;printPassMessage&lt;&#x2F;span&gt;&lt;span&gt;(PassName, -&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;, IRDescription, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;);
&lt;&#x2F;span&gt;&lt;span&gt;      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;true&lt;&#x2F;span&gt;&lt;span&gt;;
&lt;&#x2F;span&gt;&lt;span&gt;  }
&lt;&#x2F;span&gt;&lt;span&gt;  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#65737e;&quot;&gt;&#x2F;&#x2F; ...
&lt;&#x2F;span&gt;&lt;span&gt;}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æœ€ç»ˆæˆ‘å¾—åˆ°ï¼š&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2b303b;color:#c0c5ce;&quot;&gt;&lt;code&gt;&lt;span&gt;BISECT: running pass (10040) CorrelatedValuePropagationPass on symbol
&lt;&#x2F;span&gt;&lt;span&gt;BISECT: NOT running pass (10041) SimplifyCFGPass on symbol
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;ä¸ºäº†éªŒè¯ &lt;code&gt;CorrelatedValuePropagationPass&lt;&#x2F;code&gt; æ˜¯å¦æœ‰å…³ï¼Œä»ç„¶æ˜¯é€šè¿‡åˆ é™¤ä¸ç›¸å…³çš„ä»£ç ï¼Œå‚è§ï¼š&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;DianQK&#x2F;llvm-project&#x2F;commit&#x2F;a08f2c14b1d501aa9b76b96e26c7366c5a6e6e9b&quot;&gt;a08f2c14&lt;&#x2F;a&gt;ã€‚
æˆ‘è¿˜æ·»åŠ äº†ä¸€è¡Œæ—¥å¿—è¿›è¡Œç®€å•çš„éªŒè¯ï¼š&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#2b303b;color:#c0c5ce;&quot;&gt;&lt;code&gt;&lt;span&gt;LLVMLOG: Delete   %102 = and i64 %101, 4294967295   -&amp;gt; and i64 %101, 0xffffffff
&lt;&#x2F;span&gt;&lt;span&gt;...
&lt;&#x2F;span&gt;&lt;span&gt;occupied niche: found 0x7fba00000001 but must be in 0x0..=0x2 in type std::option::Option&amp;lt;thir::pattern::deconstruct_pat::SliceKind&amp;gt; at offset 0 with type Int(I64, false)
&lt;&#x2F;span&gt;&lt;span&gt;0x7fba00000001 &amp;amp; 0xffffffff = 0x1
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;æˆ‘æ•¢è‚¯å®šè¿™å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ï¼è¿™å’Œ rustc çš„ panic æ—¥å¿—æœ‰éå¸¸å¤§çš„ç›¸å…³æ€§ã€‚
æœ€ç»ˆæˆ‘å‘ç° &lt;code&gt;%101&lt;&#x2F;code&gt; åœ¨ç‰¹å®šçš„æ§åˆ¶æµä¸‹ï¼Œå¯èƒ½è·å¾— &lt;code&gt;undef&lt;&#x2F;code&gt; ç»“æœã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸åº”è¯¥åˆ é™¤ &lt;code&gt;%102&lt;&#x2F;code&gt;ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘å¾ˆå¥½å¥‡ä¸ºä»€ä¹ˆä¼šå’Œ &lt;code&gt;AggressiveInstCombine&lt;&#x2F;code&gt; æœ‰å…³ï¼Œå¦‚æœæˆ‘ä»¬å»æ‰è¿™ä¸ª Passï¼Œè¦åˆ é™¤çš„æŒ‡ä»¤å˜ä¸º &lt;code&gt;%123 = and i64 %122, 72057594037927935(0xffffffffffffff)&lt;&#x2F;code&gt;ã€‚æˆ‘ä»¬ä»ç„¶ä¸èƒ½åˆ é™¤è¿™ä¸ªæŒ‡ä»¤ï¼Œåªæ˜¯è¿™ä¸ªå·¨å¤§çš„æ•°å€¼è®©ç¨‹åºåœ¨è¿è¡ŒæœŸé—´å¾ˆéš¾é‡åˆ°ã€‚&lt;&#x2F;p&gt;
&lt;h1 id=&quot;zong-jie&quot;&gt;æ€»ç»“&lt;&#x2F;h1&gt;
&lt;p&gt;æˆ‘ä»¬æ¯”è¾ƒäº†ä»€ä¹ˆï¼Ÿ&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;é€šè¿‡æ¯”è¾ƒä¸åŒ &lt;code&gt;codegen-units&lt;&#x2F;code&gt;ï¼Œå®šä½è¢«å½±å“çš„ crate&lt;&#x2F;li&gt;
&lt;li&gt;é€šè¿‡æ·»åŠ  &lt;code&gt;[inline(never)]&lt;&#x2F;code&gt; æ¯”è¾ƒç»“æœï¼Œå®šä½è¢«å½±å“çš„å‡½æ•°&lt;&#x2F;li&gt;
&lt;li&gt;é€šè¿‡ git bisect å®šä½æ˜¯å“ªä¸ª commit å½±å“äº†ç»“æœ&lt;&#x2F;li&gt;
&lt;li&gt;é€šè¿‡ä¿®æ”¹ä»£ç ï¼Œå®šä½æ˜¯å“ªæ¬¡è½¬æ¢å½±å“äº†ç»“æœ&lt;&#x2F;li&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;-opt-bisect-limit&lt;&#x2F;code&gt; ç»“æœå®šä½æœ‰å…³è”çš„ Pass&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;æˆ‘é€šè¿‡è¿™äº›æ–¹æ³•é€æ¸æ¥è¿‘çœŸç›¸ã€‚å¯¹äº†ï¼Œè¿æ°”ä¹Ÿå¾ˆé‡è¦ï¼Œæˆ‘æ²¡æœ‰è®°å½•æˆ‘èµ°é”™è·¯çš„ç»å† :]ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;åœ¨è¿™äº›æ–¹æ³•ä¸­ï¼Œæˆ‘ä¹Ÿä»‹ç»äº†ä¸€äº›å…·ä½“æŠ€å·§ï¼š&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;git bisect æ‹¿ä¸åˆ°ç»“æœæ—¶å¯ä»¥é€šè¿‡ç§»é™¤ä¸€äº› commit æ‰¾åˆ°ç»“æœï¼ˆè¿™å¯èƒ½åªæ˜¯ç‰¹å®šåœºæ™¯çš„æŠ€å·§ï¼‰&lt;&#x2F;li&gt;
&lt;li&gt;cargo æä¾›äº†åº”ç”¨ rustc å‚æ•°åˆ°æŒ‡å®š crate çš„åŠŸèƒ½&lt;&#x2F;li&gt;
&lt;li&gt;ä¿®æ”¹ rustc ä»£ç ï¼Œå°† &lt;code&gt;opt-bisect-limit&lt;&#x2F;code&gt; åº”ç”¨åˆ°å…·ä½“çš„ CGUï¼Œè®©è¿™ä¸ªåŠŸèƒ½åœ¨å¤§å‹é¡¹ç›®ä¸Šåº”å½“å¾ˆæœ‰ç”¨&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;è§£å†³è¿™ç±»é—®é¢˜æ¦‚æ‹¬æµç¨‹æ˜¯ï¼š&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;é¦–å…ˆæƒ³åŠæ³•ç¼©çŸ­å•æ¬¡å¤ç°çš„æ—¶é—´ï¼Œå¤ªé•¿çš„è°ƒè¯•æ—¶é—´ä»¤äººæ¼ç«&lt;&#x2F;li&gt;
&lt;li&gt;å…³é”®ç›®æ ‡æ˜¯&lt;strong&gt;é€šè¿‡ä¸Šè¿°æ¯”è¾ƒæ–¹æ³•ï¼Œæ‰¾åˆ°å¯¼è‡´é”™è¯¯ç¼–è¯‘çš„å…³é”®è½¬æ¢&lt;&#x2F;strong&gt;&lt;&#x2F;li&gt;
&lt;li&gt;æå– IRï¼Œæ ¹æ®å…³é”®è½¬æ¢å®šä½é—®é¢˜&lt;&#x2F;li&gt;
&lt;li&gt;ä¿®å¤é—®é¢˜&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;æš‚æ—¶æˆ‘è¿˜æ²¡æœ‰ç¬¬ä¸‰æ­¥éª¤çš„å¿ƒå¾—ä¸ç»éªŒï¼Œä½†æˆ‘ä¼šä½¿ç”¨ &lt;code&gt;llvm-extract&lt;&#x2F;code&gt; å’Œ &lt;code&gt;llvm-reduce&lt;&#x2F;code&gt; å‡å°‘è·å¾—çš„ IRï¼Œè¿™å¯¹äºè°ƒè¯•ä¼šæœ‰äº›å¸®åŠ©ã€‚ 
æˆ‘ä¹Ÿä¼šä½¿ç”¨ &lt;code&gt;-opt-bisect-limit&lt;&#x2F;code&gt; æå–ä¸­é—´è¿‡ç¨‹çš„ IRï¼Œå¹¶æ‰‹åŠ¨åˆ é™¤ä¸€äº›å‡½æ•°æˆ–æŒ‡ä»¤å®šä½é—®é¢˜ã€‚&lt;&#x2F;p&gt;
&lt;p&gt;å¯¹äºå¦‚ä½•æäº¤ä¸€ä¸ªåˆé€‚çš„ä¿®å¤ï¼Œæˆ‘è¿˜æ²¡æœ‰æ¸…æ™°çš„æ€è·¯ï¼Œç›®å‰æˆ‘å¾ˆå°‘åšåˆ°æ— ä¿®æ”¹è·å¾— LGTM çš„ PRã€‚æˆ‘è¿˜éœ€è¦æ›´å¤šçš„å­¦ä¹ ä¸å®è·µ ;)ã€‚&lt;&#x2F;p&gt;
&lt;h1 id=&quot;can-kao&quot;&gt;å‚è€ƒ&lt;&#x2F;h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;rustc-dev-guide.rust-lang.org&#x2F;compiler-debugging.html&quot;&gt;https:&#x2F;&#x2F;rustc-dev-guide.rust-lang.org&#x2F;compiler-debugging.html&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;rustc-dev-guide.rust-lang.org&#x2F;backend&#x2F;debugging.html&quot;&gt;https:&#x2F;&#x2F;rustc-dev-guide.rust-lang.org&#x2F;backend&#x2F;debugging.html&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;llvm.org&#x2F;docs&#x2F;GitBisecting.html&quot;&gt;https:&#x2F;&#x2F;llvm.org&#x2F;docs&#x2F;GitBisecting.html&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;cargo&#x2F;reference&#x2F;unstable.html#profile-rustflags-option&quot;&gt;https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;cargo&#x2F;reference&#x2F;unstable.html#profile-rustflags-option&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;www.llvm.org&#x2F;docs&#x2F;AliasAnalysis.html&quot;&gt;https:&#x2F;&#x2F;www.llvm.org&#x2F;docs&#x2F;AliasAnalysis.html&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;rustc&#x2F;codegen-options&#x2F;index.html#lto&quot;&gt;https:&#x2F;&#x2F;doc.rust-lang.org&#x2F;rustc&#x2F;codegen-options&#x2F;index.html#lto&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
</feed>
